<p><br />[NON‑NORMATIVE HARDENING — RECOMMENDED ONLY] NOTE: All 'RR-REQ' items are treated as normative requirements. Any security/control items not explicitly mandated are placed under 'Recommended Security Hardening (Non‑Normative)' and MUST NOT be treated as regulatory requirements.</p><p><strong>RISK REGISTRY IMPLEMENTATION PLAN — FINAL (CLEAN NORMATIVE + NON‑NORMATIVE HARDENING SEPARATED)</strong></p><p><strong>İNFORMASİYA TƏHLÜKƏSİZLİYİ RİSKLƏRİ REYESTRİ</strong></p><p><strong>Risk Registry GRC Application</strong></p><p>Complete Implementation Plan: BA + Technical Specification + Developer Backlog</p><p><em>Based on: Nazirlər Kabinetinin 25.12.2025 tarixli 411 nömrəli Qərarı</em></p><p><strong>Deployment: On-Premises | Database: Single DB, Single Schema | Classification: CONFIDENTIAL</strong></p><p>Generated: February 2026</p><p><strong>DOCUMENT SCOPE &amp; HARD CONSTRAINTS</strong></p><p>1. Deployment: On-Premises only. No cloud services for sensitive risk data.</p><p>2. Database: Single PostgreSQL database + single public schema. Logical separation via table prefixes (rr_*, loc_*, cen_*, inv_*, sys_*), views, and Row-Level Security.</p><p>3. All requirements reference the exact clause number from the regulation.</p><p>4. This plan covers Outputs A through H as specified.</p><h1>A. REQUIREMENT EXTRACTION (Normative Requirements)</h1><p><em>All requirements extracted from the regulation with MUST/SHALL/OLMALIDIR/EDİLMƏLİDİR language. Each references the exact clause number.</em></p><table><tr><td><p><strong>ID</strong></p></td><td><p><strong>Maddə</strong></p></td><td><p><strong>Kateqoriya</strong></p></td><td><p><strong>Növ</strong></p></td><td><p><strong>Prioritet</strong></p></td><td><p><strong>AZ Mənbə</strong></p></td><td><p><strong>EN Tələb (İmpleментasiya)</strong></p></td></tr><tr><td><p><strong>RR-REQ-0001</strong></p></td><td><p>§1.2</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Risk idarəetmə üçün strukturlaşdırılmış informasiya konfiden...</em></p></td><td><p>Risk registry data MUST be classified as confidential, collected and protected within owner's information infrastructure.</p></td></tr><tr><td><p><strong>RR-REQ-0002</strong></p></td><td><p>§1.5</p></td><td><p>Governance</p></td><td><p>Constraint</p></td><td><p><strong>High</strong></p></td><td><p><em>Bu Qaydanın tələbləri dövlət orqanları üçün məcburidir....</em></p></td><td><p>Requirements of this Rule are MANDATORY for state bodies, public legal entities, state-owned companies, and budget organizations.</p></td></tr><tr><td><p><strong>RR-REQ-0003</strong></p></td><td><p>§1.8</p></td><td><p>Governance</p></td><td><p>Constraint</p></td><td><p><strong>High</strong></p></td><td><p><em>Risklər reyestrlərində yaradılan informasiya Azərbaycan Resp...</em></p></td><td><p>All data created in risk registries and Threats &amp; Solutions catalog is the property of Azerbaijan Republic.</p></td></tr><tr><td><p><strong>RR-REQ-0004</strong></p></td><td><p>§3.1.3</p></td><td><p>Roles/RACI</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Konkret cavabdehlik – iştirakçılar arasında məsuliyyət və sə...</em></p></td><td><p>Specific accountability: responsibility and authority MUST be defined and distributed among all participants.</p></td></tr><tr><td><p><strong>RR-REQ-0005</strong></p></td><td><p>§3.1.4</p></td><td><p>Governance</p></td><td><p>Constraint</p></td><td><p><strong>High</strong></p></td><td><p><em>İcra və nəzarət arasında bölgü – eyni rola həvalə olunmasına...</em></p></td><td><p>Separation of execution and control: the same role MUST NOT be assigned both execution and oversight of any process (SoD).</p></td></tr><tr><td><p><strong>RR-REQ-0006</strong></p></td><td><p>§4.1</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>İdarəetmənin kontekstinin əhatə sahəsinin müəyyən edilməsi t...</em></p></td><td><p>Risk management context and scope determination MUST be ensured, including objectives, principles, and criteria.</p></td></tr><tr><td><p><strong>RR-REQ-0007</strong></p></td><td><p>§4.2.2.1</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Risklərin idarə edilməsi əhatə dairəsinə aid ilkin və dəstək...</em></p></td><td><p>Primary and supporting assets within risk management scope MUST be identified.</p></td></tr><tr><td><p><strong>RR-REQ-0008</strong></p></td><td><p>§4.2.2.2</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Məlum olan, sonradan yaranan və hazırlanan təhdidlərin müəyy...</em></p></td><td><p>Known, emerging, and prepared threats (including attacks and attempts) MUST be identified.</p></td></tr><tr><td><p><strong>RR-REQ-0009</strong></p></td><td><p>§4.2.2.3</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Mühafizənin mövcud və planlaşdırılan texnologiyalarının müəy...</em></p></td><td><p>Existing and planned protection technologies (organizational and technical controls, cyber counter-intelligence) MUST be identified.</p></td></tr><tr><td><p><strong>RR-REQ-0010</strong></p></td><td><p>§4.2.2.4</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Təhdidlərin aktivlərdə istifadə edə biləcəyi uyğunsuzluqları...</em></p></td><td><p>Gaps, deficiencies, weaknesses, and nonconformities that threats can exploit in assets MUST be identified.</p></td></tr><tr><td><p><strong>RR-REQ-0011</strong></p></td><td><p>§4.2.2.5</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Təhdidlər nəticəsinde yarana bilən IS hadisələrinin müəyyən ...</em></p></td><td><p>IS events and incidents resulting from threats MUST be identified and detected.</p></td></tr><tr><td><p><strong>RR-REQ-0012</strong></p></td><td><p>§4.2.2.6</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Fəaliyyət davamlılığına, IS-ə aid yarana bilən fəsadların mü...</em></p></td><td><p>Potential consequences to business continuity, IS, and protected assets MUST be identified.</p></td></tr><tr><td><p><strong>RR-REQ-0013</strong></p></td><td><p>§4.2.3.4</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Keyfiyyət əsaslı: Risk dərəcəsi = Aktiv dəyəri × Başvermə eh...</em></p></td><td><p>Qualitative risk scoring formula MUST be implemented: Risk Score = Asset Value × Probability (avg of factors max historical) × Impact (max of technical and business factors).</p></td></tr><tr><td><p><strong>RR-REQ-0014</strong></p></td><td><p>§4.2.3.5</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Kəmiyyət əsaslı: Risk qiyməti = Aktiv dəyəri × Başvermə tezl...</em></p></td><td><p>Quantitative risk valuation formula MUST be implemented: Risk Value = Asset Value × Occurrence Frequency(%) × Impact (max).</p></td></tr><tr><td><p><strong>RR-REQ-0015</strong></p></td><td><p>§4.3.1</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Risklərin emal variantının müəyyən olunması: qarşısının alın...</em></p></td><td><p>Risk treatment option MUST be determined: avoid, mitigate, transfer, or accept.</p></td></tr><tr><td><p><strong>RR-REQ-0016</strong></p></td><td><p>§4.3.4</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Risklərin reallaşma hallarına insidentlərə cavab tədbirlərin...</em></p></td><td><p>Incident response measures for realized risks MUST be defined.</p></td></tr><tr><td><p><strong>RR-REQ-0017</strong></p></td><td><p>§5.2</p></td><td><p>Data/DB</p></td><td><p>Constraint</p></td><td><p><strong>High</strong></p></td><td><p><em>Risklər reyestrinin strukturu 4 bölmədən ibarət müəyyən olun...</em></p></td><td><p>Registry structure MUST comprise 4 components: main DB, local source DBs, central source DBs, solution technology inventory.</p></td></tr><tr><td><p><strong>RR-REQ-0018</strong></p></td><td><p>§5.4</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Lokal mənbələrə ilkin və dəstəkləyici aktivlər barədə təfsil...</em></p></td><td><p>Local source DBs MUST contain detailed data on primary and supporting assets at the level enabling nonconformity component identification.</p></td></tr><tr><td><p><strong>RR-REQ-0019</strong></p></td><td><p>§5.5</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Mərkəzi mənbə 'Təhdidlər və həllər' kataloqunun tərkibindədi...</em></p></td><td><p>Central source MUST include: centralized normative requirements, threat taxonomy, generic solutions catalog, risks/incidents list.</p></td></tr><tr><td><p><strong>RR-REQ-0020</strong></p></td><td><p>§5.9</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Lokal və mərkəzi mənbələr risklərin idarə edilməsi proseslər...</em></p></td><td><p>Local and central source DBs MUST be determined before risk management processes and MUST be regularly updated to maintain relevance.</p></td></tr><tr><td><p><strong>RR-REQ-0021</strong></p></td><td><p>§6.3</p></td><td><p>Service/Operations</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Risklər reyestri sahibin özü və operatoru tərəfindən 'Risklə...</em></p></td><td><p>Risk registry MUST be maintained by owner and/or operator via the 'Risk Registry' digital service.</p></td></tr><tr><td><p><strong>RR-REQ-0022</strong></p></td><td><p>§6.4</p></td><td><p>Service/Operations</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>'Risklər reyestri' rəqəmsal xidməti bu Qaydaya uyğun funksio...</em></p></td><td><p>Digital service MUST have functionality, configuration, and protection tools compliant with this Regulation and owner-defined requirements.</p></td></tr><tr><td><p><strong>RR-REQ-0023</strong></p></td><td><p>§6.6</p></td><td><p>Compliance/Certification</p></td><td><p>Constraint</p></td><td><p><strong>High</strong></p></td><td><p><em>ISO/IEC 27001, 27005, 20000 standartlarına və ITIL qabaqcıl ...</em></p></td><td><p>Digital service functionality MUST comply with ISO/IEC 27001, ISO/IEC 27005, ISO/IEC 20000, and ITIL best practices.</p></td></tr><tr><td><p><strong>RR-REQ-0024</strong></p></td><td><p>§6.8</p></td><td><p>Service/Operations</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>'Risklər reyestri' rəqəmsal xidmətinin funksionallığı risklə...</em></p></td><td><p>Digital service functionality MUST cover full risk management (assessment and treatment).</p></td></tr><tr><td><p><strong>RR-REQ-0025</strong></p></td><td><p>§6.9.1</p></td><td><p>Service/Operations</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>İKT qulluq risklər reyestrinin DB idarə edilməsi, strukturu,...</em></p></td><td><p>ICT maintenance MUST cover: DB management, structure creation, additions/changes, and reconciliation with source systems.</p></td></tr><tr><td><p><strong>RR-REQ-0026</strong></p></td><td><p>§6.9.2</p></td><td><p>Audit/Logging</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>IS hadisələrinə dair qeydlər sistem jurnallarından real vaxt...</em></p></td><td><p>IS events logs MUST be collected from system journals in real-time into centralized storage.</p></td></tr><tr><td><p><strong>RR-REQ-0027</strong></p></td><td><p>§7.1.2</p></td><td><p>Roles/RACI</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Proseslər, bu proseslərə aidiyyəti olan rollar, məsuliyyətin...</em></p></td><td><p>Processes, associated roles, and RACI matrices MUST be defined and documented.</p></td></tr><tr><td><p><strong>RR-REQ-0028</strong></p></td><td><p>§7.1.3</p></td><td><p>Integration</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>'Təhdidlər və həllər' kataloqundan təhdidlər və həllər riskl...</em></p></td><td><p>Threat and solution data from 'Threats &amp; Solutions' catalog MUST be regularly imported and updated in the registry.</p></td></tr><tr><td><p><strong>RR-REQ-0029</strong></p></td><td><p>§7.1.4</p></td><td><p>Integration</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Risklər reyestrindən yeni aşkar olunan təhdidlər 'Təhdidlər ...</em></p></td><td><p>Newly discovered threats from registry MUST be exported to the 'Threats &amp; Solutions' catalog.</p></td></tr><tr><td><p><strong>RR-REQ-0030</strong></p></td><td><p>§7.1.6</p></td><td><p>Security</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Məlumatlara, texniki xidmətlərə, proqram vasitələrinə səlahi...</em></p></td><td><p>Access rights to data, technical services, software modules MUST be defined and distributed among user roles (RBAC).</p></td></tr><tr><td><p><strong>RR-REQ-0031</strong></p></td><td><p>§7.1.7</p></td><td><p>Security</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Risklər reyestrinin informasiya təhlükəsizliyi təmin edilir....</em></p></td><td><p>Information security of the risk registry MUST be ensured by the owner.</p></td></tr><tr><td><p><strong>RR-REQ-0032</strong></p></td><td><p>§9.2</p></td><td><p>Security</p></td><td><p>Constraint</p></td><td><p><strong>High</strong></p></td><td><p><em>Hər bir risklər reyestrinin informasiya təhlükəsizliyinə həm...</em></p></td><td><p>The owner of each risk registry is ACCOUNTABLE for its information security.</p></td></tr><tr><td><p><strong>RR-REQ-0033</strong></p></td><td><p>§9.3</p></td><td><p>Roles/RACI</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Məsuliyyət və səlahiyyətlər əvvəlcədən müəyyən olunur və car...</em></p></td><td><p>Responsibilities and authorities MUST be pre-defined and enforced during operations.</p></td></tr><tr><td><p><strong>RR-REQ-0034</strong></p></td><td><p>§9.4</p></td><td><p>Compliance/Certification</p></td><td><p>Constraint</p></td><td><p><strong>High</strong></p></td><td><p><em>Təşkilati alətlər ISO/IEC 15504 üzrə yetkinlik ≥4; texniki a...</em></p></td><td><p>Organizational tools MUST achieve ISO/IEC 15504 maturity level ≥ 4; technical tools MUST meet ISO/IEC 15408 EAL 6 (verification, validation, penetration testing). Security tools MUST be certified.</p></td></tr><tr><td><p><strong>RR-REQ-0035</strong></p></td><td><p>§9.5</p></td><td><p>Security</p></td><td><p>Constraint</p></td><td><p><strong>High</strong></p></td><td><p><em>Əsas cədvəl, uyğunsuzluqların ünvanı, mühafizə vasitələri in...</em></p></td><td><p>Main registry table, nonconformity addresses, protection tools data MUST be protected by information security controls; knowledge bases MUST only reside in the responsible entity's information resources; NO transfer to centralized catalog or other spaces permitted.</p></td></tr><tr><td><p><strong>RR-REQ-0036</strong></p></td><td><p>§9.6</p></td><td><p>Audit/Logging</p></td><td><p>Evidence/Audit</p></td><td><p><strong>High</strong></p></td><td><p><em>Hər bir risklər reyestrinin konfiqurasiyasının uyğunluğunun ...</em></p></td><td><p>Configuration and functionality compliance assessment MUST be performed by both the owner and the Service (Xidmət).</p></td></tr><tr><td><p><strong>RR-REQ-0037</strong></p></td><td><p>§10.3</p></td><td><p>Audit/Logging</p></td><td><p>Evidence/Audit</p></td><td><p><strong>High</strong></p></td><td><p><em>Sahib tərəfindən mütəmadi, Xidmət tərəfindən ildə 1 dəfədən ...</em></p></td><td><p>Effectiveness MUST be evaluated by the owner regularly and by the Service at least once per year.</p></td></tr><tr><td><p><strong>RR-REQ-0038</strong></p></td><td><p>§Annex §1</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Risklər reyestrinin mərkəz cədvəlinə müəyyən edilmiş 10 kate...</em></p></td><td><p>Main registry central table MUST include all 10 data categories as defined in the Annex.</p></td></tr><tr><td><p><strong>RR-REQ-0039</strong></p></td><td><p>§Annex §2</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>IS tələbləri üçün məlumatlar: tələb mənbəyi, fəaliyyət sahəs...</em></p></td><td><p>IS requirements data MUST include: requirement, source, activity area, IS principles, ISMS organizational/technical/human/physical requirements.</p></td></tr><tr><td><p><strong>RR-REQ-0040</strong></p></td><td><p>§Annex §2.2</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Məqbul hədlər: MAO/MBCO, yetkinlik hədləri, CIA hədləri, SLA...</em></p></td><td><p>Acceptable thresholds data MUST include: MAO, MBCO, maturity thresholds, CIA thresholds, SLA/OLA, EAL thresholds, RACI matrices, performance thresholds.</p></td></tr><tr><td><p><strong>RR-REQ-0041</strong></p></td><td><p>§Annex §3</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Təhdid məlumatları: 21 sahə, o cümlədən kateqoriya, mənbə, c...</em></p></td><td><p>Threat data MUST capture 21 data fields including category, violated requirement, source (internal/external), severity (5 levels), probability (5 bands: 1-20% to 81-99%), purpose, target object, intentionality, exploited nonconformity, realization technology, and potential consequence.</p></td></tr><tr><td><p><strong>RR-REQ-0042</strong></p></td><td><p>§Annex §4</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Fəsad məlumatları: mahiyyəti, kateqoriyası, növü, ciddilik v...</em></p></td><td><p>Consequence data MUST include: nature, category (decision/execution/control/improvement), type (business continuity violation, reputational, normative, staff harm, technological lag, financial, asset loss), severity, and probability.</p></td></tr><tr><td><p><strong>RR-REQ-0043</strong></p></td><td><p>§Annex §5</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Uyğunsuzluq məlumatları: mahiyyəti, kateqoriyası, ünvan obye...</em></p></td><td><p>Nonconformity data MUST include: nature, category (gap, lack of control, weakness), target object, and severity.</p></td></tr><tr><td><p><strong>RR-REQ-0044</strong></p></td><td><p>§Annex §6.1</p></td><td><p>Process</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Risklərin emalı üsulları: 4 variant + insidentlərə cavabın 1...</em></p></td><td><p>Treatment methods MUST cover 4 treatment options and 13 incident response phases (detect, notify, monitor, assess, block, restore, change, update, improve, failover, rollback, evidence, anti-crisis).</p></td></tr><tr><td><p><strong>RR-REQ-0045</strong></p></td><td><p>§Annex §6.2</p></td><td><p>Data/DB</p></td><td><p>Functional</p></td><td><p><strong>Medium</strong></p></td><td><p><em>Risklərin emalı vasitələri: proqram/texniki vasitələr + süni...</em></p></td><td><p>Treatment tools data MUST include: software/hardware tools with configs, EAL/capability thresholds, and AI-based solutions (SIEM, SOAR, UEBA, DLP, Big Data, Threat Intel, OODA, etc.).</p></td></tr><tr><td><p><strong>RR-REQ-0046</strong></p></td><td><p>§10.2.1</p></td><td><p>Audit/Logging</p></td><td><p>Evidence/Audit</p></td><td><p><strong>High</strong></p></td><td><p><em>Konfiqurasiyanın uyğunluğu üzrə 10 ölçmə parametri (metrics)...</em></p></td><td><p>10 configuration compliance metrics MUST be formulated and applied covering asset-scope alignment, requirements-catalog alignment, baseline-requirements alignment, threat-baseline alignment, registry-threat alignment, treatment option-registry alignment, and recovery method-tool alignment.</p></td></tr><tr><td><p><strong>RR-REQ-0047</strong></p></td><td><p>§10.2.2</p></td><td><p>Audit/Logging</p></td><td><p>Evidence/Audit</p></td><td><p><strong>High</strong></p></td><td><p><em>Funksionallığın səmərəliyi üzrə 5 ölçmə parametri tətbiq olu...</em></p></td><td><p>5 functionality effectiveness metrics MUST be applied covering: data access/completeness, method/tool relevance to new threats, knowledge base accessibility, residual risk levels, and incident-to-residual-risk alignment.</p></td></tr><tr><td><p><strong>RR-REQ-0048</strong></p></td><td><p>§8.1.5</p></td><td><p>Integration</p></td><td><p>Functional</p></td><td><p><strong>High</strong></p></td><td><p><em>Xidmət tərəfindən risklər reyestrlərində müstəqil mərkəzləşm...</em></p></td><td><p>The Service MUST conduct independent centralized measurements (compliance assessment, effectiveness evaluation) in risk registries and report results to owners.</p></td></tr></table><h1>B. BUSINESS REQUIREMENTS (BA / BRD)</h1><p><em>Business requirements derived from normative requirements, expressed in business language with actors, inputs/outputs, evidence, and KPIs.</em></p><table><tr><td><p><strong>BR ID</strong></p></td><td><p><strong>Ref</strong></p></td><td><p><strong>Title / Başlıq</strong></p></td><td><p><strong>Business Intent</strong></p></td><td><p><strong>Actors</strong></p></td><td><p><strong>Inputs / Outputs</strong></p></td><td><p><strong>Evidence</strong></p></td><td><p><strong>KPI / Metrics</strong></p></td></tr><tr><td><p><strong>BR-0001</strong></p></td><td><p><em>RR-REQ-0001/§1.2</em></p></td><td><p><strong>Risk Reyestrinin Məxfiliyinin Təmini</strong></p></td><td><p>IS risk management data classified as confidential and stored exclusively within owner's secure infrastructure.</p></td><td><p>Owner (Sahib), Operator</p></td><td><p>IN: Risk data, IS events, threat data OUT: Protected risk registry database</p></td><td><p>Audit log of data access, classification labels on all records</p></td><td><p>100% of records classified; 0 unauthorized exports</p></td></tr><tr><td><p><strong>BR-0002</strong></p></td><td><p><em>RR-REQ-0002/§1.5</em></p></td><td><p><strong>Dövlət Qurumları üçün Məcburilik</strong></p></td><td><p>Ensure mandatory compliance by all covered state bodies.</p></td><td><p>Owner, Xidmət (regulator)</p></td><td><p>IN: Organization list, compliance status OUT: Compliance reports, audit findings</p></td><td><p>Annual compliance audit by Xidmət</p></td><td><p>100% covered organizations with active registry</p></td></tr><tr><td><p><strong>BR-0003</strong></p></td><td><p><em>RR-REQ-0005/§3.1.4</em></p></td><td><p><strong>Vəzifə Ayrılığının (SoD) Tətbiqi</strong></p></td><td><p>No single role performs both execution and oversight of the same process.</p></td><td><p>System Admin, Security Officer, Auditor</p></td><td><p>IN: Role definitions, process assignments OUT: RACI matrix, SoD conflict report</p></td><td><p>SoD violation alert log, quarterly RACI review</p></td><td><p>0 SoD violations in role assignments</p></td></tr><tr><td><p><strong>BR-0004</strong></p></td><td><p><em>RR-REQ-0007/§4.2.2.1</em></p></td><td><p><strong>Aktiv İnventarının İdarəsi</strong></p></td><td><p>Comprehensive identification and cataloging of primary and supporting information assets.</p></td><td><p>Asset Owner, IS Officer</p></td><td><p>IN: Organization's IT infrastructure data OUT: Asset catalog with classifications</p></td><td><p>Asset register, last-updated timestamps</p></td><td><p>Asset coverage ≥95% of known infrastructure</p></td></tr><tr><td><p><strong>BR-0005</strong></p></td><td><p><em>RR-REQ-0013/§4.2.3.4</em></p></td><td><p><strong>Keyfiyyət Əsaslı Risk Qiymətləndirilməsi</strong></p></td><td><p>Implement qualitative risk scoring formula per regulation.</p></td><td><p>Risk Analyst</p></td><td><p>IN: Asset value, threat probability, impact factors OUT: Qualitative risk score (Risk dərəcəsi)</p></td><td><p>Calculation audit trail per risk record</p></td><td><p>100% risks scored using mandated formula</p></td></tr><tr><td><p><strong>BR-0006</strong></p></td><td><p><em>RR-REQ-0014/§4.2.3.5</em></p></td><td><p><strong>Kəmiyyət Əsaslı Risk Qiymətləndirilməsi</strong></p></td><td><p>Implement quantitative risk valuation formula.</p></td><td><p>Risk Analyst</p></td><td><p>IN: Asset value, occurrence frequency (%), impact OUT: Quantitative risk value (Risk qiyməti)</p></td><td><p>Formula audit trail, historical data used</p></td><td><p>100% risks with quantitative value where frequency data available</p></td></tr><tr><td><p><strong>BR-0007</strong></p></td><td><p><em>RR-REQ-0015/§4.3.1</em></p></td><td><p><strong>Risk Emal Variantının Seçilməsi</strong></p></td><td><p>For each identified risk, select appropriate treatment: avoid, mitigate, transfer, or accept.</p></td><td><p>Risk Owner, Risk Committee</p></td><td><p>IN: Risk score, risk appetite, treatment options catalog OUT: Treatment decision record with justification</p></td><td><p>Approval workflow audit trail</p></td><td><p>100% high/critical risks with approved treatment plan</p></td></tr><tr><td><p><strong>BR-0008</strong></p></td><td><p><em>RR-REQ-0017/§5.2</em></p></td><td><p><strong>Reyestr Strukturunun 4 Komponentdə Qurulması</strong></p></td><td><p>Implement the four-component DB architecture as mandated.</p></td><td><p>System Architect, DBA</p></td><td><p>IN: Regulation requirements OUT: Single-schema DB with rr_*, loc_*, cen_*, inv_* table prefixes</p></td><td><p>Schema documentation, table inventory</p></td><td><p>All 4 logical sections implemented and populated</p></td></tr><tr><td><p><strong>BR-0009</strong></p></td><td><p><em>RR-REQ-0026/§6.9.2</em></p></td><td><p><strong>Real Vaxt Jurnallaşdırma</strong></p></td><td><p>Real-time centralized collection of IS event logs.</p></td><td><p>System Administrator, SIEM</p></td><td><p>IN: System journals, IS event data OUT: Centralized audit log store</p></td><td><p>Log completeness metrics, SIEM integration proof</p></td><td><p>Log delivery latency &lt;1 min; 0 gaps in log collection</p></td></tr><tr><td><p><strong>BR-0010</strong></p></td><td><p><em>RR-REQ-0027/§7.1.2</em></p></td><td><p><strong>RACI Matrisasının Yaradılması</strong></p></td><td><p>Define and document all processes, roles, and responsibility distribution matrices.</p></td><td><p>Owner, Process Owner</p></td><td><p>IN: Process list, role definitions OUT: RACI matrix document per process</p></td><td><p>Signed/approved RACI matrix, version history</p></td><td><p>100% processes with RACI; reviewed ≥annually</p></td></tr><tr><td><p><strong>BR-0011</strong></p></td><td><p><em>RR-REQ-0034/§9.4</em></p></td><td><p><strong>EAL6 + Maturity Level 4 Uyğunluğu</strong></p></td><td><p>Achieve required assurance levels: organizational tools at maturity ≥4, technical tools at EAL 6.</p></td><td><p>CISO, External Evaluator, Certification Body</p></td><td><p>IN: Current maturity assessment, EAL evaluation artifacts OUT: Certification evidence, audit reports</p></td><td><p>ISO/IEC 15408 EAL6 certificate, 15504 maturity assessment report, pentest reports, verification/validation artifacts</p></td><td><p>EAL6 certification maintained; maturity reassessed annually</p></td></tr><tr><td><p><strong>BR-0012</strong></p></td><td><p><em>RR-REQ-0035/§9.5</em></p></td><td><p><strong>Həssas Məlumatların Məxfilik Hüdudları</strong></p></td><td><p>Sensitive registry data (main table, nonconformity addresses, protection tools) must not be transferred outside owner's information space.</p></td><td><p>Data Protection Officer, System Admin</p></td><td><p>IN: Data classification, access requests OUT: Data residency controls, DLP policies</p></td><td><p>DLP alerts log, no-transfer audit</p></td><td><p>0 unauthorized data transfers; 100% sensitive fields encrypted at rest</p></td></tr><tr><td><p><strong>BR-0013</strong></p></td><td><p><em>RR-REQ-0037/§10.3</em></p></td><td><p><strong>Səmərəlilik Dəyərləndirilməsi</strong></p></td><td><p>Regular effectiveness evaluation by owner; annual evaluation by Xidmət.</p></td><td><p>Owner, Xidmət Auditor</p></td><td><p>IN: 15 KPI metrics (10 config + 5 functionality) OUT: Effectiveness report with metric scores</p></td><td><p>Signed evaluation report, submitted to Xidmət</p></td><td><p>All 15 metrics measured; Xidmət report submitted annually</p></td></tr><tr><td><p><strong>BR-0014</strong></p></td><td><p><em>RR-REQ-0028/§7.1.3 + RR-REQ-0029/§7.1.4</em></p></td><td><p><strong>Mərkəzi Kataloqla İnteqrasiya (Bi-directional)</strong></p></td><td><p>Bidirectional sync with Xidmət's 'Threats &amp; Solutions' catalog: import threats/solutions, export new discoveries.</p></td><td><p>Operator, Integration Service</p></td><td><p>IN: Catalog API/feed, registry new findings OUT: Updated registry, catalog enrichment submissions</p></td><td><p>Sync log, submission receipts from Xidmət</p></td><td><p>Sync latency ≤24h; 100% new threats submitted</p></td></tr><tr><td><p><strong>BR-0015</strong></p></td><td><p><em>RR-REQ-0044/§Annex §6.1.5</em></p></td><td><p><strong>İnsidentlərə Cavab İş Axını</strong></p></td><td><p>Implement 13-phase incident response workflow per regulation.</p></td><td><p>SOC Analyst, Incident Commander</p></td><td><p>IN: Detected incident OUT: Incident response record with all 13 phase logs</p></td><td><p>Incident timeline, phase completion records</p></td><td><p>100% incidents with complete 13-phase documentation</p></td></tr></table><h1>C. SYSTEM ARCHITECTURE (High-Level)</h1><h2>C.1 Application Modules</h2><p><strong>Risk Management Module: </strong>Core risk lifecycle: identification, assessment (qualitative + quantitative scoring), treatment (avoid/mitigate/transfer/accept), and tracking. Implements §4.2, §4.3 and Annex §1.</p><p><strong>Asset Management Module (loc_*): </strong>Manages primary and supporting asset catalog per §4.2.2.1, §5.4. Feeds asset value into risk scoring formulas.</p><p><strong>Threat Registry Module (loc_threat): </strong>Records all 21 Annex §3 threat fields. Links threats to assets, nonconformities, and consequences.</p><p><strong>Vulnerability / Nonconformity Module (loc_nonconformity): </strong>Tracks gaps, weaknesses, and control deficiencies per Annex §5. Links to threats and risks.</p><p><strong>Incident Response Module (rr_incident): </strong>Implements 13-phase sequential incident response workflow per Annex §6.1.5. Linked to realized risks.</p><p><strong>Central Catalog Integration Module (cen_*): </strong>Bidirectional sync with Xidmét's 'Threats &amp; Solutions' catalog: import threats/solutions (§7.1.3), export new discoveries (§7.1.4). API/file-based integration.</p><p><strong>Solution Technology Inventory Module (inv_*): </strong>Tracks all IS solution tools with EAL certification status, AI technology tags, and configuration parameters per Annex §6.2.</p><p><strong>Requirements &amp; Thresholds Module (cen_requirement, cen_threshold): </strong>Centralized normative requirements (ISO/IEC 27001/27005, national laws) and acceptable thresholds (MAO, MBCO, CIA, SLA, EAL) per Annex §2.</p><p><strong>RACI &amp; Governance Module: </strong>Manages RACI matrices per §7.1.2, SoD enforcement per §3.1.4, role definitions, and process-role assignments.</p><p><strong>Effectiveness Metrics &amp; Reporting Module: </strong>Computes and displays 15 KPI metrics per §10.2 (10 config compliance + 5 functionality effectiveness). Annual report generation per §10.3.</p><p><strong>Audit &amp; Logging Module (sys_*): </strong>Append-only audit log with checksums, entity versioning snapshots. Real-time SIEM integration per §6.9.2.</p><p><strong>Administration Module: </strong>User management, RBAC configuration, system configuration, ICT maintenance features per §6.9.</p><h2>C.2 Trust Boundaries &amp; Access Model</h2><p><strong>Zone 1 - Data Layer: </strong>PostgreSQL 16 with RLS enabled. All sensitive tables (rr_risk main, nonconformity addresses, protection methods) encrypted at rest (AES-256). Access only via application service account. Direct DB access prohibited except for Operator/Admin via VPN + MFA.</p><p><br />[NON‑NORMATIVE HARDENING — RECOMMENDED ONLY] Zone 2 - Application Layer: REST API backend (e.g., Spring Boot / .NET). JWT authentication with 8-hour token expiry. All inter-module calls internal only. No public internet exposure per §9.5 (data must remain in owner's information space).</p><p><strong>Zone 3 - Presentation Layer: </strong>React/Vue SPA served from internal web server. Role-based UI rendering. No caching of sensitive data in browser localStorage.</p><p><strong>Zone 4 - Integration Layer: </strong>One-way inbound from Xidmét catalog (scheduled pull via API/SFTP). One-way outbound submissions to Xidmét. Air-gapped from production DB; sync service uses staging buffer. Per §9.5: no transfer of main table or knowledge base to external systems.</p><p><strong>Zone 5 - Audit/SIEM Layer: </strong>Real-time log forwarding to on-prem SIEM (Wazuh/Splunk/Elastic). sys_audit_log write-once enforced by DB trigger. SIEM read-only access to audit schema.</p><h2>C.3 Integration Points (as referenced in regulation)</h2><p><strong>Xidmét 'Threats &amp; Solutions' Catalog (§7.1.3/7.1.4/8.1): </strong>Bidirectional: Pull threats/solutions (scheduled); Push new discoveries. Protocol: REST API or encrypted SFTP.</p><p><strong>Existing Asset CMDB/Inventory (§5.4 (local source)): </strong>Import assets to loc_asset. One-time migration + periodic delta sync. Protocol: REST API or CSV import.</p><p><strong>On-Prem SIEM (§6.9.2): </strong>Real-time syslog/event forwarding. Protocol: Syslog TCP/TLS or SIEM native API.</p><p><strong>Active Directory / LDAP (§9.3 (RBAC)): </strong>User authentication and role mapping. Protocol: LDAPS.</p><p><strong>PKI / Certificate Authority (§9.4 (EAL6 tooling)): </strong>Certificate validation for certified tools. Protocol: OCSP/CRL.</p><h1>D. DATA MODEL + DB BLUEPRINT (Single DB, Single Schema)</h1><p><em>All tables in a single PostgreSQL database and single public schema. Logical separation via table name prefixes only. Row-Level Security (RLS) enforces access control at DB level.</em></p><h2>D.1 Table Inventory</h2><p><strong>rr_* — Core Risk Registry (Əsas Reyestr)</strong></p><p>  • rr_risk: Central risk table - core entity linking all risk attributes per Annex §1</p><p>  • rr_incident: Incident records - risk realization facts per Annex §1.8</p><p>  • rr_treatment: Risk treatment records and methods per §4.3, Annex §6</p><p>  • rr_reconciliation: Reconciliation/sync records between registry and source tables per Annex §1.10</p><p><strong>loc_* — Local Sources (Lokal Mənbələr)</strong></p><p>  • loc_asset: Primary and supporting assets - local asset register per §5.4, §4.2.2.1</p><p>  • loc_threat: Local threat records with 21 mandatory fields per Annex §3</p><p>  • loc_nonconformity: Nonconformities/vulnerabilities per Annex §5</p><p>  • loc_consequence: Consequence records per Annex §4</p><p><strong>cen_* — Central Catalog (Mərkəzi Mənbə)</strong></p><p>  • cen_requirement: Centralized normative IS requirements per §5.5.1, Annex §2</p><p>  • cen_threshold: Acceptable IS thresholds per Annex §2.2 (MAO, MBCO, CIA thresholds, EAL, SLA)</p><p>  • cen_threat_catalog: Central threat taxonomy from Xidmét catalog per §5.5.2, Annex §3</p><p>  • cen_solution: Generic/anonymized solutions for risk treatment and incident response per §5.5.3</p><p>  • cen_raci_matrix: RACI matrices per process and role per §7.1.2, Annex §2.2.7</p><p><strong>inv_* — Solution Technology Inventory (Həllər İnventarı)</strong></p><p>  • inv_solution_tool: Inventory of IS solution technologies per §5.2.4, §5.7, Annex §6.2</p><p><strong>sys_* — System/Audit</strong></p><p>  • sys_audit_log: Append-only audit log for all data changes per §6.9.2, §9.4</p><p>  • sys_entity_snapshot: Entity versioning snapshots for full change history</p><h2>D.2 Detailed Table Specifications</h2><p><strong>Table: rr_risk</strong></p><p><em>Section: Core Risk Registry | Purpose: Central risk table - core entity linking all risk attributes per Annex §1</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>risk_id</strong></p></td><td><p>UUID PK</p></td><td></td><td><p>Primary key</p></td></tr><tr><td><p><strong>risk_code</strong></p></td><td><p>VARCHAR(50) UNIQUE</p></td><td></td><td><p>Human-readable code e.g. RISK-2025-001</p></td></tr><tr><td><p><strong>risk_category</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td><p>Risk category per §Annex 1.1</p></td></tr><tr><td><p><strong>risk_nature</strong></p></td><td><p>TEXT</p></td><td></td><td><p>Risk nature description</p></td></tr><tr><td><p><strong>probability_level</strong></p></td><td><p>SMALLINT 1-5</p></td><td></td><td><p>Probability score</p></td></tr><tr><td><p><strong>severity_level</strong></p></td><td><p>SMALLINT 1-5</p></td><td></td><td><p>Severity score</p></td></tr><tr><td><p><strong>qualitative_score</strong></p></td><td><p>DECIMAL(10,4)</p></td><td></td><td><p>Risk dərəcəsi = AV x P x I (§4.2.3.4)</p></td></tr><tr><td><p><strong>quantitative_value</strong></p></td><td><p>DECIMAL(12,4)</p></td><td></td><td><p>Risk qiyməti = AV x F% x I (§4.2.3.5)</p></td></tr><tr><td><p><strong>treatment_option</strong></p></td><td><p>ENUM(avoid,mitigate,transfer,accept)</p></td><td></td><td><p>§4.3.1 treatment option</p></td></tr><tr><td><p><strong>residual_risk_score</strong></p></td><td><p>DECIMAL(10,4)</p></td><td></td><td><p>Qalıq risk after treatment</p></td></tr><tr><td><p><strong>status</strong></p></td><td><p>ENUM(identified,assessed,treating,closed,accepted)</p></td><td></td><td><p>Risk lifecycle state</p></td></tr><tr><td><p><strong>owner_id</strong></p></td><td><p>UUID FK-&gt;users</p></td><td></td><td><p>Risk owner role</p></td></tr><tr><td><p><strong>asset_id</strong></p></td><td><p>UUID FK-&gt;loc_asset</p></td><td></td><td><p>Linked primary asset</p></td></tr><tr><td><p><strong>threat_id</strong></p></td><td><p>UUID FK-&gt;loc_threat</p></td><td></td><td><p>Linked threat</p></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td><p>Creation timestamp</p></td></tr><tr><td><p><strong>updated_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td><p>Last update</p></td></tr><tr><td><p><strong>version</strong></p></td><td><p>INTEGER DEFAULT 1</p></td><td></td><td><p>Optimistic locking</p></td></tr><tr><td><p><strong>is_deleted</strong></p></td><td><p>BOOLEAN DEFAULT FALSE</p></td><td></td><td><p>Soft delete</p></td></tr></table><p><strong>Table: rr_incident</strong></p><p><em>Section: Core Risk Registry | Purpose: Incident records - risk realization facts per Annex §1.8</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>incident_id</strong></p></td><td><p>UUID PK</p></td><td></td><td><p>Primary key</p></td></tr><tr><td><p><strong>risk_id</strong></p></td><td><p>UUID FK-&gt;rr_risk</p></td><td></td><td><p>Realized risk</p></td></tr><tr><td><p><strong>incident_code</strong></p></td><td><p>VARCHAR(50) UNIQUE</p></td><td></td><td><p>INC-2025-001 format</p></td></tr><tr><td><p><strong>detected_at</strong></p></td><td><p>TIMESTAMPTZ</p></td><td></td><td><p>Detection timestamp</p></td></tr><tr><td><p><strong>response_phase</strong></p></td><td><p>ENUM(detect,notify,monitor,assess,block,restore,change,update,improve,failover,rollback,evidence,anticrisis)</p></td><td></td><td><p>Current phase per Annex §6.1.5</p></td></tr><tr><td><p><strong>severity</strong></p></td><td><p>SMALLINT 1-5</p></td><td></td><td><p>Incident severity</p></td></tr><tr><td><p><strong>status</strong></p></td><td><p>ENUM(open,in_progress,resolved,closed)</p></td><td></td><td><p>Incident status</p></td></tr><tr><td><p><strong>response_option_id</strong></p></td><td><p>UUID FK-&gt;rr_treatment</p></td><td></td><td><p>Applied response</p></td></tr><tr><td><p><strong>responder_id</strong></p></td><td><p>UUID FK-&gt;users</p></td><td></td><td><p>Incident handler</p></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr><tr><td><p><strong>updated_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: rr_treatment</strong></p><p><em>Section: Core Risk Registry | Purpose: Risk treatment records and methods per §4.3, Annex §6</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>treatment_id</strong></p></td><td><p>UUID PK</p></td><td></td><td><p>Primary key</p></td></tr><tr><td><p><strong>risk_id</strong></p></td><td><p>UUID FK-&gt;rr_risk</p></td><td></td><td><p>Treated risk</p></td></tr><tr><td><p><strong>treatment_type</strong></p></td><td><p>ENUM(avoid,mitigate,transfer,accept)</p></td><td></td><td><p>§4.3.1</p></td></tr><tr><td><p><strong>method_description</strong></p></td><td><p>TEXT</p></td><td></td><td><p>Treatment method §4.3.2</p></td></tr><tr><td><p><strong>tool_id</strong></p></td><td><p>UUID FK-&gt;inv_solution_tool</p></td><td></td><td><p>Applied tool</p></td></tr><tr><td><p><strong>approved_by</strong></p></td><td><p>UUID FK-&gt;users</p></td><td></td><td><p>Approver</p></td></tr><tr><td><p><strong>approved_at</strong></p></td><td><p>TIMESTAMPTZ</p></td><td></td><td><p>Approval time</p></td></tr><tr><td><p><strong>effective_from</strong></p></td><td><p>DATE</p></td><td></td><td><p>Treatment effective date</p></td></tr><tr><td><p><strong>effective_to</strong></p></td><td><p>DATE</p></td><td></td><td><p>Planned review date</p></td></tr><tr><td><p><strong>status</strong></p></td><td><p>ENUM(planned,active,completed,cancelled)</p></td><td></td><td></td></tr></table><p><strong>Table: rr_reconciliation</strong></p><p><em>Section: Core Risk Registry | Purpose: Reconciliation/sync records between registry and source tables per Annex §1.10</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>recon_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>risk_id</strong></p></td><td><p>UUID FK-&gt;rr_risk</p></td><td></td><td></td></tr><tr><td><p><strong>source_table</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td><p>Source table name</p></td></tr><tr><td><p><strong>source_record_id</strong></p></td><td><p>UUID</p></td><td></td><td><p>FK to source record</p></td></tr><tr><td><p><strong>sync_status</strong></p></td><td><p>ENUM(synced,pending,conflict,error)</p></td><td></td><td></td></tr><tr><td><p><strong>last_synced_at</strong></p></td><td><p>TIMESTAMPTZ</p></td><td></td><td></td></tr><tr><td><p><strong>conflict_details</strong></p></td><td><p>JSONB</p></td><td></td><td><p>Conflict details if any</p></td></tr></table><p><strong>Table: loc_asset</strong></p><p><em>Section: Local Sources | Purpose: Primary and supporting assets - local asset register per §5.4, §4.2.2.1</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>asset_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>asset_code</strong></p></td><td><p>VARCHAR(50) UNIQUE</p></td><td></td><td></td></tr><tr><td><p><strong>asset_name</strong></p></td><td><p>VARCHAR(255) NOT NULL</p></td><td></td><td></td></tr><tr><td><p><strong>asset_category</strong></p></td><td><p>ENUM(primary,supporting)</p></td><td></td><td><p>İlkin / dəstəkləyici</p></td></tr><tr><td><p><strong>asset_type</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td><p>IT system, data, service, etc.</p></td></tr><tr><td><p><strong>asset_value</strong></p></td><td><p>DECIMAL(12,2)</p></td><td></td><td><p>Monetary or ordinal value for formula</p></td></tr><tr><td><p><strong>owner_id</strong></p></td><td><p>UUID FK-&gt;users</p></td><td></td><td><p>Asset owner</p></td></tr><tr><td><p><strong>confidentiality_level</strong></p></td><td><p>SMALLINT 1-5</p></td><td></td><td><p>C in CIA</p></td></tr><tr><td><p><strong>integrity_level</strong></p></td><td><p>SMALLINT 1-5</p></td><td></td><td><p>I in CIA</p></td></tr><tr><td><p><strong>availability_level</strong></p></td><td><p>SMALLINT 1-5</p></td><td></td><td><p>A in CIA</p></td></tr><tr><td><p><strong>location</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>Physical/logical location</p></td></tr><tr><td><p><strong>is_active</strong></p></td><td><p>BOOLEAN DEFAULT TRUE</p></td><td></td><td></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr><tr><td><p><strong>updated_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: loc_threat</strong></p><p><em>Section: Local Sources | Purpose: Local threat records with 21 mandatory fields per Annex §3</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>threat_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>threat_code</strong></p></td><td><p>VARCHAR(50) UNIQUE</p></td><td></td><td><p>THR-2025-001</p></td></tr><tr><td><p><strong>threat_name</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>§3.1 - threat name</p></td></tr><tr><td><p><strong>threat_category</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td><p>§3.1 - category</p></td></tr><tr><td><p><strong>violated_requirement_id</strong></p></td><td><p>UUID FK-&gt;cen_requirement</p></td><td></td><td><p>§3.2</p></td></tr><tr><td><p><strong>violated_principle</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>§3.2</p></td></tr><tr><td><p><strong>requirement_source</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>§3.3</p></td></tr><tr><td><p><strong>activity_area</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>§3.4</p></td></tr><tr><td><p><strong>source_type</strong></p></td><td><p>ENUM(internal,external)</p></td><td></td><td><p>§3.12</p></td></tr><tr><td><p><strong>severity</strong></p></td><td><p>ENUM(very_low,low,medium,high,critical)</p></td><td></td><td><p>§3.13</p></td></tr><tr><td><p><strong>probability_pct_min</strong></p></td><td><p>SMALLINT</p></td><td></td><td><p>§3.14 - lower bound %</p></td></tr><tr><td><p><strong>probability_pct_max</strong></p></td><td><p>SMALLINT</p></td><td></td><td><p>§3.14 - upper bound %</p></td></tr><tr><td><p><strong>purpose</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>§3.15 - tamper/steal/disclose/block etc.</p></td></tr><tr><td><p><strong>target_object_type</strong></p></td><td><p>ENUM(structure,infra_component,config_param,process,subject)</p></td><td></td><td><p>§3.16</p></td></tr><tr><td><p><strong>intentionality</strong></p></td><td><p>ENUM(intentional,accidental,flow_based)</p></td><td></td><td><p>§3.17</p></td></tr><tr><td><p><strong>nonconformity_id</strong></p></td><td><p>UUID FK-&gt;loc_nonconformity</p></td><td></td><td><p>§3.18 - exploited nonconformity</p></td></tr><tr><td><p><strong>realization_technology</strong></p></td><td><p>TEXT</p></td><td></td><td><p>§3.20</p></td></tr><tr><td><p><strong>potential_consequence_id</strong></p></td><td><p>UUID FK-&gt;loc_consequence</p></td><td></td><td><p>§3.21</p></td></tr><tr><td><p><strong>asset_id</strong></p></td><td><p>UUID FK-&gt;loc_asset</p></td><td></td><td><p>Target asset</p></td></tr><tr><td><p><strong>catalog_threat_id</strong></p></td><td><p>UUID FK-&gt;cen_threat_catalog</p></td><td></td><td><p>Link to central catalog</p></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr><tr><td><p><strong>updated_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: loc_nonconformity</strong></p><p><em>Section: Local Sources | Purpose: Nonconformities/vulnerabilities per Annex §5</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>nonconf_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>nonconf_name</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>§5.1</p></td></tr><tr><td><p><strong>nonconf_category</strong></p></td><td><p>ENUM(gap,lack_of_control,weakness,other)</p></td><td></td><td><p>§5.2</p></td></tr><tr><td><p><strong>target_object_type</strong></p></td><td><p>ENUM(structure,infra_component,config_param,process,subject)</p></td><td></td><td><p>§5.3</p></td></tr><tr><td><p><strong>target_object_ref</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>Specific component reference</p></td></tr><tr><td><p><strong>severity</strong></p></td><td><p>ENUM(very_low,low,medium,high,critical)</p></td><td></td><td><p>§5.4</p></td></tr><tr><td><p><strong>asset_id</strong></p></td><td><p>UUID FK-&gt;loc_asset</p></td><td></td><td><p>Affected asset</p></td></tr><tr><td><p><strong>detected_at</strong></p></td><td><p>DATE</p></td><td></td><td></td></tr><tr><td><p><strong>resolved_at</strong></p></td><td><p>DATE</p></td><td></td><td></td></tr><tr><td><p><strong>status</strong></p></td><td><p>ENUM(open,mitigated,accepted,closed)</p></td><td></td><td></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: loc_consequence</strong></p><p><em>Section: Local Sources | Purpose: Consequence records per Annex §4</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>consequence_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>consequence_name</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>§4.1</p></td></tr><tr><td><p><strong>category</strong></p></td><td><p>ENUM(decision_making,execution,control,improvement)</p></td><td></td><td><p>§4.2</p></td></tr><tr><td><p><strong>consequence_type</strong></p></td><td><p>ENUM(business_continuity_breach,reputational,normative,staff_harm,technological_lag,financial,asset_loss)</p></td><td></td><td><p>§4.3</p></td></tr><tr><td><p><strong>severity</strong></p></td><td><p>ENUM(very_low,low,medium,high,critical)</p></td><td></td><td><p>§4.4</p></td></tr><tr><td><p><strong>probability_pct_min</strong></p></td><td><p>SMALLINT</p></td><td></td><td><p>§4.5</p></td></tr><tr><td><p><strong>probability_pct_max</strong></p></td><td><p>SMALLINT</p></td><td></td><td><p>§4.5</p></td></tr><tr><td><p><strong>estimated_financial_impact</strong></p></td><td><p>DECIMAL(14,2)</p></td><td></td><td><p>Optional monetary estimate</p></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: cen_requirement</strong></p><p><em>Section: Central Catalog | Purpose: Centralized normative IS requirements per §5.5.1, Annex §2</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>requirement_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>requirement_code</strong></p></td><td><p>VARCHAR(50) UNIQUE</p></td><td></td><td></td></tr><tr><td><p><strong>requirement_name</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>§2.1.1</p></td></tr><tr><td><p><strong>category</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td><p>§2.1.1 - requirement category</p></td></tr><tr><td><p><strong>source_type</strong></p></td><td><p>ENUM(legal,standard,contract,obligation,best_practice,practical)</p></td><td></td><td><p>§2.1.2</p></td></tr><tr><td><p><strong>source_reference</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>e.g. ISO/IEC 27001:2022 A.5.1</p></td></tr><tr><td><p><strong>activity_area</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>§2.1.3 - applicable domain</p></td></tr><tr><td><p><strong>isms_scope</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td><p>§2.1.6 - organizational/technical/human/physical</p></td></tr><tr><td><p><strong>requirement_text</strong></p></td><td><p>TEXT</p></td><td></td><td><p>Full requirement text</p></td></tr><tr><td><p><strong>effective_date</strong></p></td><td><p>DATE</p></td><td></td><td></td></tr><tr><td><p><strong>is_active</strong></p></td><td><p>BOOLEAN DEFAULT TRUE</p></td><td></td><td></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr><tr><td><p><strong>updated_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: cen_threshold</strong></p><p><em>Section: Central Catalog | Purpose: Acceptable IS thresholds per Annex §2.2 (MAO, MBCO, CIA thresholds, EAL, SLA)</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>threshold_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>threshold_type</strong></p></td><td><p>ENUM(MAO,MBCO,maturity,CIA_integrity,CIA_availability,CIA_confidentiality,CIA_authenticity,SLA,OLA,EAL,work_regime,RACI,performance,documentation)</p></td><td></td><td><p>§2.2.1-2.2.10</p></td></tr><tr><td><p><strong>scope_description</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>Process or system this threshold applies to</p></td></tr><tr><td><p><strong>threshold_value</strong></p></td><td><p>JSONB</p></td><td></td><td><p>Flexible value storage per threshold type</p></td></tr><tr><td><p><strong>unit</strong></p></td><td><p>VARCHAR(50)</p></td><td></td><td><p>hours, %, level, etc.</p></td></tr><tr><td><p><strong>eal_level</strong></p></td><td><p>SMALLINT</p></td><td></td><td><p>§2.2.5 - EAL level (1-7)</p></td></tr><tr><td><p><strong>priority_level</strong></p></td><td><p>SMALLINT 1-5</p></td><td></td><td></td></tr><tr><td><p><strong>criticality_level</strong></p></td><td><p>SMALLINT 1-5</p></td><td></td><td></td></tr><tr><td><p><strong>approved_by</strong></p></td><td><p>UUID FK-&gt;users</p></td><td></td><td></td></tr><tr><td><p><strong>effective_date</strong></p></td><td><p>DATE</p></td><td></td><td></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: cen_threat_catalog</strong></p><p><em>Section: Central Catalog | Purpose: Central threat taxonomy from Xidmét catalog per §5.5.2, Annex §3</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>catalog_threat_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>threat_code</strong></p></td><td><p>VARCHAR(50) UNIQUE</p></td><td></td><td><p>National catalog code</p></td></tr><tr><td><p><strong>threat_name</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td></td></tr><tr><td><p><strong>threat_category</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td></td></tr><tr><td><p><strong>source_type</strong></p></td><td><p>ENUM(internal,external)</p></td><td></td><td></td></tr><tr><td><p><strong>severity</strong></p></td><td><p>ENUM(very_low,low,medium,high,critical)</p></td><td></td><td></td></tr><tr><td><p><strong>probability_band</strong></p></td><td><p>ENUM(very_low_1_20,low_21_40,medium_41_60,high_61_80,critical_81_99)</p></td><td></td><td><p>§3.14</p></td></tr><tr><td><p><strong>purpose</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>§3.15</p></td></tr><tr><td><p><strong>target_object_types</strong></p></td><td><p>JSONB</p></td><td></td><td><p>§3.16 - array</p></td></tr><tr><td><p><strong>intentionality</strong></p></td><td><p>VARCHAR(50)</p></td><td></td><td><p>§3.17</p></td></tr><tr><td><p><strong>realization_technology</strong></p></td><td><p>TEXT</p></td><td></td><td><p>§3.20</p></td></tr><tr><td><p><strong>catalog_version</strong></p></td><td><p>VARCHAR(20)</p></td><td></td><td><p>Version from Xidmét</p></td></tr><tr><td><p><strong>last_synced_at</strong></p></td><td><p>TIMESTAMPTZ</p></td><td></td><td></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: cen_solution</strong></p><p><em>Section: Central Catalog | Purpose: Generic/anonymized solutions for risk treatment and incident response per §5.5.3</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>solution_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>solution_code</strong></p></td><td><p>VARCHAR(50) UNIQUE</p></td><td></td><td></td></tr><tr><td><p><strong>solution_name</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td></td></tr><tr><td><p><strong>treatment_type</strong></p></td><td><p>ENUM(avoid,mitigate,transfer,accept,incident_response)</p></td><td></td><td><p>§6.1 methods</p></td></tr><tr><td><p><strong>method_category</strong></p></td><td><p>ENUM(preventive,detective,corrective,recovery)</p></td><td></td><td></td></tr><tr><td><p><strong>description</strong></p></td><td><p>TEXT</p></td><td></td><td><p>Generic/anonymized per §5.5.3</p></td></tr><tr><td><p><strong>applicable_threat_categories</strong></p></td><td><p>JSONB</p></td><td></td><td><p>Array of applicable threat categories</p></td></tr><tr><td><p><strong>catalog_version</strong></p></td><td><p>VARCHAR(20)</p></td><td></td><td></td></tr><tr><td><p><strong>last_synced_at</strong></p></td><td><p>TIMESTAMPTZ</p></td><td></td><td></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: cen_raci_matrix</strong></p><p><em>Section: Central Catalog | Purpose: RACI matrices per process and role per §7.1.2, Annex §2.2.7</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>raci_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>process_name</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>Process identifier</p></td></tr><tr><td><p><strong>role_name</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td><p>Role name</p></td></tr><tr><td><p><strong>raci_type</strong></p></td><td><p>ENUM(R,A,C,I)</p></td><td></td><td><p>Responsible/Accountable/Consulted/Informed</p></td></tr><tr><td><p><strong>notes</strong></p></td><td><p>TEXT</p></td><td></td><td></td></tr><tr><td><p><strong>version</strong></p></td><td><p>INTEGER DEFAULT 1</p></td><td></td><td></td></tr><tr><td><p><strong>approved_by</strong></p></td><td><p>UUID FK-&gt;users</p></td><td></td><td></td></tr><tr><td><p><strong>approved_at</strong></p></td><td><p>TIMESTAMPTZ</p></td><td></td><td></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: inv_solution_tool</strong></p><p><em>Section: Solution Technology Inventory | Purpose: Inventory of IS solution technologies per §5.2.4, §5.7, Annex §6.2</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>tool_id</strong></p></td><td><p>UUID PK</p></td><td></td><td></td></tr><tr><td><p><strong>tool_code</strong></p></td><td><p>VARCHAR(50) UNIQUE</p></td><td></td><td></td></tr><tr><td><p><strong>tool_name</strong></p></td><td><p>VARCHAR(255) NOT NULL</p></td><td></td><td></td></tr><tr><td><p><strong>tool_type</strong></p></td><td><p>ENUM(software,hardware,firmware,service,ai_based)</p></td><td></td><td><p>§6.2.1</p></td></tr><tr><td><p><strong>tool_category</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td><p>SIEM/SOAR/DLP/UEBA/EDR etc. per Annex §6.2.2</p></td></tr><tr><td><p><strong>vendor</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td></td></tr><tr><td><p><strong>version</strong></p></td><td><p>VARCHAR(50)</p></td><td></td><td></td></tr><tr><td><p><strong>functional_purpose</strong></p></td><td><p>TEXT</p></td><td></td><td><p>§6.2.1</p></td></tr><tr><td><p><strong>config_components</strong></p></td><td><p>JSONB</p></td><td></td><td><p>Configuration components and parameters</p></td></tr><tr><td><p><strong>capability_thresholds</strong></p></td><td><p>JSONB</p></td><td></td><td><p>Capacity limits</p></td></tr><tr><td><p><strong>eal_level</strong></p></td><td><p>SMALLINT</p></td><td></td><td><p>EAL certification level</p></td></tr><tr><td><p><strong>is_certified</strong></p></td><td><p>BOOLEAN DEFAULT FALSE</p></td><td></td><td><p>§9.4 - tool must be certified</p></td></tr><tr><td><p><strong>certification_reference</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td><p>Certificate number/body</p></td></tr><tr><td><p><strong>certification_expiry</strong></p></td><td><p>DATE</p></td><td></td><td></td></tr><tr><td><p><strong>asset_id</strong></p></td><td><p>UUID FK-&gt;loc_asset</p></td><td></td><td><p>Associated asset where deployed</p></td></tr><tr><td><p><strong>is_ai_based</strong></p></td><td><p>BOOLEAN DEFAULT FALSE</p></td><td></td><td><p>AI/ML based per §6.2.2</p></td></tr><tr><td><p><strong>ai_technology_tags</strong></p></td><td><p>JSONB</p></td><td></td><td><p>SIEM,SOAR,UEBA,DLP,BigData,ThreatIntel,OODA,DeepLearning,E2E,CorpusLing</p></td></tr><tr><td><p><strong>status</strong></p></td><td><p>ENUM(planned,active,decommissioned)</p></td><td></td><td></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr><tr><td><p><strong>updated_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL</p></td><td></td><td></td></tr></table><p><strong>Table: sys_audit_log</strong></p><p><em>Section: System / Audit | Purpose: Append-only audit log for all data changes per §6.9.2, §9.4</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>log_id</strong></p></td><td><p>BIGSERIAL PK</p></td><td></td><td><p>Monotonically increasing</p></td></tr><tr><td><p><strong>event_time</strong></p></td><td><p>TIMESTAMPTZ NOT NULL DEFAULT NOW()</p></td><td></td><td><p>Immutable timestamp</p></td></tr><tr><td><p><strong>user_id</strong></p></td><td><p>UUID NOT NULL FK-&gt;users</p></td><td></td><td></td></tr><tr><td><p><strong>user_role</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td><p>Role at time of event</p></td></tr><tr><td><p><strong>action</strong></p></td><td><p>ENUM(CREATE,READ,UPDATE,DELETE,LOGIN,LOGOUT,EXPORT,IMPORT,APPROVE,REJECT,SYNC)</p></td><td></td><td></td></tr><tr><td><p><strong>table_name</strong></p></td><td><p>VARCHAR(100)</p></td><td></td><td><p>Affected table</p></td></tr><tr><td><p><strong>record_id</strong></p></td><td><p>UUID</p></td><td></td><td><p>Affected record primary key</p></td></tr><tr><td><p><strong>old_values</strong></p></td><td><p>JSONB</p></td><td></td><td><p>Previous state snapshot</p></td></tr><tr><td><p><strong>new_values</strong></p></td><td><p>JSONB</p></td><td></td><td><p>New state snapshot</p></td></tr><tr><td><p><strong>ip_address</strong></p></td><td><p>INET</p></td><td></td><td><p>Client IP</p></td></tr><tr><td><p><strong>session_id</strong></p></td><td><p>VARCHAR(255)</p></td><td></td><td></td></tr><tr><td><p><strong>checksum</strong></p></td><td><p>CHAR(64)</p></td><td></td><td><p>SHA-256 of (log_id+event_time+user_id+action+record_id+old+new)</p></td></tr></table><p><strong>Table: sys_entity_snapshot</strong></p><p><em>Section: System / Audit | Purpose: Entity versioning snapshots for full change history</em></p><table><tr><td><p><strong>Column</strong></p></td><td><p><strong>Type / Constraint</strong></p></td><td><p><strong>Regulation Ref</strong></p></td><td><p><strong>Notes</strong></p></td></tr><tr><td><p><strong>snapshot_id</strong></p></td><td><p>BIGSERIAL PK</p></td><td></td><td></td></tr><tr><td><p><strong>entity_table</strong></p></td><td><p>VARCHAR(100) NOT NULL</p></td><td></td><td></td></tr><tr><td><p><strong>entity_id</strong></p></td><td><p>UUID NOT NULL</p></td><td></td><td></td></tr><tr><td><p><strong>snapshot_version</strong></p></td><td><p>INTEGER NOT NULL</p></td><td></td><td></td></tr><tr><td><p><strong>snapshot_data</strong></p></td><td><p>JSONB NOT NULL</p></td><td></td><td><p>Full entity state</p></td></tr><tr><td><p><strong>created_by</strong></p></td><td><p>UUID FK-&gt;users</p></td><td></td><td></td></tr><tr><td><p><strong>created_at</strong></p></td><td><p>TIMESTAMPTZ NOT NULL DEFAULT NOW()</p></td><td></td><td></td></tr><tr><td><p><strong>checksum</strong></p></td><td><p>CHAR(64)</p></td><td></td><td><p>SHA-256 of snapshot_data</p></td></tr></table><h2>D.3 Access Control Matrix (Roles × Tables)</h2><p><em>CRUD = Create/Read/Update/Delete. Enforced via PostgreSQL Row-Level Security policies AND application-layer authorization.</em></p><table><tr><td><p><strong>Table</strong></p></td><td><p><strong>Risk Owner</strong></p></td><td><p><strong>Risk Analyst</strong></p></td><td><p><strong>IS Officer</strong></p></td><td><p><strong>Auditor</strong></p></td><td><p><strong>Operator/Admin</strong></p></td><td><p><strong>Xidmət Auditor</strong></p></td><td><p><strong>Read-Only</strong></p></td></tr><tr><td><p><strong>rr_risk</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>CR</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>rr_incident</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>rr_treatment</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>CR</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>rr_reconciliation</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>loc_asset</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>CR</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>loc_threat</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>loc_nonconformity</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>loc_consequence</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>cen_requirement</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>cen_threshold</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>cen_threat_catalog</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R(sync)</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>cen_solution</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R(sync)</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>cen_raci_matrix</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>inv_solution_tool</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>CRU</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>CRUD</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td></tr><tr><td><p><strong>sys_audit_log</strong></p></td><td><p><strong>R(own)</strong></p></td><td><p><strong>R(own)</strong></p></td><td><p><strong>R</strong></p></td><td><p>READ</p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>—</strong></p></td></tr><tr><td><p><strong>sys_entity_snapshot</strong></p></td><td><p><strong>R(own)</strong></p></td><td><p><strong>R(own)</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>R</strong></p></td><td><p><strong>—</strong></p></td></tr></table><h2>D.4 Audit &amp; Immutability Strategy</h2><p><strong>Append-Only Log: </strong>sys_audit_log: INSERT-only via PostgreSQL BEFORE DELETE/UPDATE triggers that block deletions. DB role for audit table: INSERT only, no UPDATE/DELETE. Monotonically increasing log_id (BIGSERIAL) + SHA-256 checksum of (log_id + event_time + user_id + action + record_id + old_values + new_values) stored per row.</p><p><strong>Entity Versioning: </strong>sys_entity_snapshot: AFTER INSERT/UPDATE trigger creates full JSON snapshot of entity state. Each snapshot has version number + SHA-256 checksum. Enables point-in-time recovery and audit.</p><p><br />[NON‑NORMATIVE HARDENING — RECOMMENDED ONLY] Data Retention (§9.5 / §1.7): Audit logs: minimum 5 years. Risk records: lifetime of risk + 3 years after closure. Snapshots: same as parent entity. Archival per Presidential Decree No. 263 (2018-09-12) on state information resources.</p><p><strong>Integrity Checks: </strong>Nightly checksum verification job comparing stored checksums vs. recomputed values. Any mismatch triggers CRITICAL alert to IS Officer and SIEM.</p><h1>E. BACKEND TECHNICAL SPECIFICATION</h1><h2>E.1 API Endpoints (REST)</h2><p><em>Base URL: https://{internal-host}/api/v1 | Auth: Bearer JWT in Authorization header | Content-Type: application/json</em></p><table><tr><td><p><strong>Method</strong></p></td><td><p><strong>Path</strong></p></td><td><p><strong>Description</strong></p></td><td><p><strong>Auth / Roles</strong></p></td><td><p><strong>Validation</strong></p></td><td><p><strong>Error Codes</strong></p></td></tr><tr><td><p><strong>POST</strong></p></td><td><p>/api/auth/login</p></td><td><p>Authenticate user, return JWT</p></td><td><p>Public</p></td><td><p>username, password required</p></td><td><p>401 Invalid credentials, 423 Account locked</p></td></tr><tr><td><p><strong>GET</strong></p></td><td><p>/api/risks</p></td><td><p>List risks with filters (status, category, asset, owner)</p></td><td><p>Any authenticated role</p></td><td><p>Pagination: page, pageSize ≤100</p></td><td><p>400 Invalid filter</p></td></tr><tr><td><p><strong>POST</strong></p></td><td><p>/api/risks</p></td><td><p>Create new risk (§4.2)</p></td><td><p>Risk Analyst, IS Officer</p></td><td><p>asset_id, threat_id, category, probability_level, severity_level required</p></td><td><p>422 Validation errors, 409 Duplicate risk code</p></td></tr><tr><td><p><strong>GET</strong></p></td><td><p>/api/risks/{id}</p></td><td><p>Get risk detail with linked threat, asset, nonconformity</p></td><td><p>Any authenticated</p></td><td><p>UUID format</p></td><td><p>404 Not found, 403 No access</p></td></tr><tr><td><p><strong>PUT</strong></p></td><td><p>/api/risks/{id}</p></td><td><p>Update risk (creates snapshot in sys_entity_snapshot)</p></td><td><p>Risk Analyst, IS Officer</p></td><td><p>All mandatory fields, optimistic lock via version field</p></td><td><p>409 Conflict (stale version), 422</p></td></tr><tr><td><p><strong>POST</strong></p></td><td><p>/api/risks/{id}/transition</p></td><td><p>Risk state transition (identified→assessed→treating→closed)</p></td><td><p>IS Officer, Risk Owner (role-dependent per RACI)</p></td><td><p>body: {target_state, justification}, SoD check</p></td><td><p>403 SoD violation, 400 Invalid transition</p></td></tr><tr><td><p><strong>GET</strong></p></td><td><p>/api/risks/{id}/score</p></td><td><p>Calculate and return risk scores (qualitative + quantitative)</p></td><td><p>Risk Analyst, IS Officer</p></td><td><p>Risk must be in assessed state</p></td><td><p>400 Missing asset value or probability data</p></td></tr><tr><td><p><strong>GET</strong></p></td><td><p>/api/assets</p></td><td><p>List assets (loc_asset)</p></td><td><p>Any authenticated</p></td><td><p>Pagination, filter by category/owner</p></td><td></td></tr><tr><td><p><strong>POST</strong></p></td><td><p>/api/assets</p></td><td><p>Create asset</p></td><td><p>Risk Analyst, IS Officer, Operator</p></td><td><p>name, category, asset_value, CIA levels required</p></td><td><p>422</p></td></tr><tr><td><p><strong>GET</strong></p></td><td><p>/api/threats</p></td><td><p>List local threats</p></td><td><p>Any authenticated</p></td><td><p>Filter by severity, category, asset</p></td><td></td></tr><tr><td><p><strong>POST</strong></p></td><td><p>/api/threats</p></td><td><p>Create threat with all 21 Annex §3 fields</p></td><td><p>Risk Analyst, IS Officer</p></td><td><p>All 21 mandatory fields validated</p></td><td><p>422 Missing required fields per Annex §3</p></td></tr><tr><td><p><strong>GET</strong></p></td><td><p>/api/nonconformities</p></td><td><p>List nonconformities</p></td><td><p>Any authenticated</p></td><td></td><td></td></tr><tr><td><p><strong>POST</strong></p></td><td><p>/api/incidents</p></td><td><p>Create incident linked to risk</p></td><td><p>IS Officer</p></td><td><p>risk_id, severity required</p></td><td><p>422</p></td></tr><tr><td><p><strong>PUT</strong></p></td><td><p>/api/incidents/{id}/phase</p></td><td><p>Advance incident to next phase (sequential enforcement)</p></td><td><p>IS Officer</p></td><td><p>next_phase must be next sequential per §6.1.5 workflow</p></td><td><p>400 Phase sequence violation</p></td></tr><tr><td><p><strong>GET</strong></p></td><td><p>/api/catalog/threats</p></td><td><p>List central threat catalog (cen_threat_catalog)</p></td><td><p>Any authenticated</p></td><td><p>Filter by severity, category, probability_band</p></td><td></td></tr><tr><td><p><strong>POST</strong></p></td><td><p>/api/catalog/sync</p></td><td><p>Trigger catalog sync from Xidmét (§7.1.3)</p></td><td><p>Operator/Admin</p></td><td></td><td><p>502 Xidmét API unavailable</p></td></tr><tr><td><p><strong>POST</strong></p></td><td><p>/api/catalog/export</p></td><td><p>Export new locally-discovered threats to Xidmét (§7.1.4)</p></td><td><p>IS Officer, Operator</p></td><td><p>threat_id list, all must be approved locally</p></td><td><p>422</p></td></tr><tr><td><p><strong>GET</strong></p></td><td><p>/api/metrics</p></td><td><p>Get all 15 effectiveness metrics (§10.2)</p></td><td><p>IS Officer, Owner, Xidmét Auditor</p></td><td><p>Optional date range</p></td><td></td></tr><tr><td><p><strong>POST</strong></p></td><td><p>/api/reports/effectiveness</p></td><td><p>Generate annual effectiveness report (§10.3)</p></td><td><p>Owner</p></td><td><p>report_year required</p></td><td><p>422</p></td></tr><tr><td><p><strong>GET</strong></p></td><td><p>/api/audit-logs</p></td><td><p>Query audit logs (RLS enforced per role)</p></td><td><p>Auditor (all), others (own records only)</p></td><td><p>Filter: table, action, date range, user_id</p></td><td><p>403 if filtering other user without Auditor role</p></td></tr><tr><td><p><strong>GET</strong></p></td><td><p>/api/raci</p></td><td><p>Get RACI matrices</p></td><td><p>Any authenticated</p></td><td><p>Filter by process</p></td><td></td></tr><tr><td><p><strong>POST</strong></p></td><td><p>/api/raci</p></td><td><p>Create/update RACI entry with SoD validation</p></td><td><p>IS Officer, Operator</p></td><td><p>SoD conflict check on save; same role cannot be R+supervisor</p></td><td><p>409 SoD conflict</p></td></tr></table><h2>E.2 Risk Lifecycle State Machine (§4.2, §4.3, §6.2, §6.8)</h2><ul><li>IDENTIFIED → ASSESSED: Trigger: Risk Analyst completes all 21 fields + scoring formula applied. Guard: asset_id, threat_id, probability_level, severity_level all populated. Actor: Risk Analyst.</li><li>ASSESSED → TREATING: Trigger: IS Officer approves risk and selects treatment option (avoid/mitigate/transfer/accept). Guard: treatment_option set, justification provided, SoD check (approver ≠ creator). Actor: IS Officer.</li><li>TREATING → CLOSED: Trigger: Treatment plan fully executed, residual_risk_score within risk tolerance. Guard: rr_treatment record with status=completed exists. Actor: Risk Owner (sign-off), IS Officer (verification).</li><li>TREATING → ACCEPTED: Trigger: Risk formally accepted by Risk Owner despite non-zero residual risk. Guard: formal acceptance document, approved_by IS Officer. Actor: Risk Owner.</li><li>ANY STATE → INCIDENT: Trigger: Risk realized (incident detected). Guard: Automatic or manual linkage to rr_incident. No state change on risk; incident created in parallel.</li><li>Incident: OPEN → 13 sequential phases → RESOLVED → CLOSED. Each phase transition immutable in audit log.</li></ul><h2>E.3 Reconciliation / Sync Logic (§6.9.1, §7.1.3, §7.1.4)</h2><ul><li>Catalog Import (Pull): Scheduled job every 6-24h. Fetch delta from Xidmét API (or SFTP encrypted file). Compare catalog_version and last_synced_at. Insert new threats to cen_threat_catalog; update existing if version newer. Map Xidmét fields to local schema. Log every sync event in sys_audit_log (action=IMPORT). Update rr_reconciliation with sync_status.</li><li>Local→Catalog Export (Push): IS Officer marks locally-discovered threat as 'ready for submission'. Export service packages threat data, strips locally-sensitive fields (nonconformity addresses, specific asset refs per §9.5). POST to Xidmét submission API. Store submission receipt in rr_reconciliation. Track submission_status.</li><li>Asset CMDB Sync: Scheduled or on-demand pull from source CMDB system. Map to loc_asset schema. Conflict detection: if local modification newer than CMDB, flag as conflict in rr_reconciliation. Asset deletions in CMDB set is_active=false (no hard delete).</li><li>Reconciliation Rules: All sync operations logged; conflicts require manual resolution by IS Officer; all reconciliation events in sys_audit_log.</li></ul><h2>E.4 Mandatory Audit Events Log</h2><ul><li>AUTH_LOGIN / AUTH_LOGOUT / AUTH_FAILED: All authentication events</li><li>RISK_CREATE / RISK_UPDATE / RISK_STATE_TRANSITION / RISK_DELETE(soft): All risk lifecycle events</li><li>INCIDENT_CREATE / INCIDENT_PHASE_ADVANCE / INCIDENT_CLOSE: All incident events</li><li>TREATMENT_CREATE / TREATMENT_APPROVE / TREATMENT_COMPLETE: Treatment workflow</li><li>ASSET_CREATE / ASSET_UPDATE / ASSET_DEACTIVATE: Asset changes</li><li>THREAT_CREATE / THREAT_UPDATE / THREAT_SUBMIT_TO_CATALOG: Threat events</li><li>CATALOG_SYNC_START / CATALOG_SYNC_COMPLETE / CATALOG_SYNC_ERROR: Integration events (§7.1.3)</li><li>SCORE_CALCULATED: Every risk scoring calculation with formula inputs stored</li><li>EXPORT_ATTEMPT / EXPORT_BLOCKED: Data export attempts (§9.5)</li><li>RBAC_CHANGE / SOD_VIOLATION_ATTEMPT: Access control events</li><li>CONFIG_CHANGE: Any system configuration modification</li><li>METRIC_CALCULATED: Effectiveness metric computation</li><li>REPORT_GENERATED: Report generation events</li><li>AUDIT_LOG_ACCESS: Who accessed the audit log (meta-audit)</li></ul><h1>F. FRONTEND SPECIFICATION</h1><h2>F.1 Screen List &amp; Navigation</h2><p><strong>Dashboard / Ana Səhifə: </strong>Overview of risk summary, open incidents, overdue treatments, metric scores. Role-filtered widgets. | Roles: All roles</p><p><strong>Risk Reyestri (Risk Registry List): </strong>Paginated/filterable list of all risks with status, score, category. Export to PDF. | Roles: All authenticated</p><p><strong>Risk Əlavə et / Redaktə et (Create/Edit Risk): </strong>Full risk form: 21+ fields including risk category, asset link, threat link, scoring inputs. Scoring calculated on save. | Roles: Risk Analyst, IS Officer</p><p><strong>Risk Detalı (Risk Detail): </strong>View risk with linked threat, asset, nonconformity, treatment plan, incidents, score breakdown, audit trail. | Roles: All authenticated</p><p><strong>Risk Emal (Treatment Plan): </strong>Treatment option selector (4 options), method/tool selection, approval workflow, effective dates. | Roles: Risk Analyst, IS Officer, Risk Owner</p><p><strong>Aktiv Kataloqu (Asset Catalog): </strong>Asset list with CIA scores, asset value, owner. Import from CMDB. | Roles: IS Officer, Risk Analyst, Operator</p><p><strong>Aktiv Əlavə et / Redaktə et: </strong>Asset form: name, type, category (primary/supporting), asset value, CIA levels, owner. | Roles: IS Officer, Operator</p><p><strong>Təhdid Reyestri (Threat Registry): </strong>List of loc_threat records with 21-field view. | Roles: All authenticated</p><p><strong>Təhdid Əlavə et: </strong>21-field threat form per Annex §3. Severity/probability dropdowns with defined scales. Link to asset, nonconformity. | Roles: Risk Analyst, IS Officer</p><p><strong>Uyğunsuzluqlar (Nonconformities): </strong>List and CRUD for loc_nonconformity. Severity filter. Link to threats and assets. | Roles: Risk Analyst, IS Officer</p><p><strong>Fəsadlar (Consequences): </strong>List and CRUD for loc_consequence. Category/type dropdowns per Annex §4. | Roles: Risk Analyst, IS Officer</p><p><strong>İnsidentlər (Incidents): </strong>Incident list with status. Linked to risks. | Roles: IS Officer, Auditor, Read-Only</p><p><strong>İnsident Detalı / 13-Mərhələ (Incident Detail + 13-Phase Workflow): </strong>Sequential phase progress tracker. Each phase: timestamp, responsible person, notes, evidence attachment. Immutable on completion. | Roles: IS Officer</p><p><strong>Mərkəzi Katalog - Tələblər (Central Requirements): </strong>Read-only view of cen_requirement. Filter by source type, ISMS scope. | Roles: All authenticated</p><p><strong>Mərkəzi Katalog - Təhdidlər (Central Threats): </strong>Read-only view of cen_threat_catalog. Sync status indicator. | Roles: All authenticated</p><p><strong>Mərkəzi Katalog - Həllər (Central Solutions): </strong>Read-only view of cen_solution. | Roles: All authenticated</p><p><strong>Hədlər (Thresholds): </strong>cen_threshold management: MAO/MBCO, CIA thresholds, SLA/OLA, EAL. IS Officer edit rights. | Roles: IS Officer, Operator</p><p><strong>Həll Texnologiyaları İnventarı (Solution Tools Inventory): </strong>inv_solution_tool list with certification status, EAL level, AI tags. Alert for expiring certifications. | Roles: IS Officer, Operator</p><p><strong>RACI Matrisası: </strong>Process-role matrix builder. SoD conflict visual indicator. Export to PDF. | Roles: IS Officer, Operator, Admin</p><p><strong>Rollar və İstifadəçilər (Roles &amp; Users): </strong>User management: assign roles, view SoD conflicts, LDAP sync status. | Roles: Admin only</p><p><strong>Effektivlik Göstəriciləri / KPI Dashboard (§10.2): </strong>15 metric scores: 10 config compliance + 5 functionality. Traffic-light indicators. Trend charts. Export button for annual report. | Roles: IS Officer, Owner, Xidmét Auditor</p><p><strong>İllik Hesabat (Annual Report §10.3): </strong>Report generator. All 15 metrics included. Owner sign-off. Submission to Xidmét tracking. | Roles: Owner</p><p><strong>Audit Jurnalı (Audit Log): </strong>Queryable audit log: filter by user, action, table, date range. Auditor: all records. Others: own records only. Read-only. | Roles: Auditor, IS Officer, all (own)</p><p><br />[NON‑NORMATIVE HARDENING — RECOMMENDED ONLY] Sistem Tənzimləmələri (System Settings): DB maintenance, catalog sync settings, SIEM integration config, retention policy. | Roles: Admin/Operator only</p><p><strong>Sinxronizasiya (Catalog Sync): </strong>Manual sync trigger, sync history log, conflict resolution UI, submission status. | Roles: Operator, Admin</p><h2>F.2 Mandatory Form Fields per Regulation</h2><p><strong>Risk Form (§4.2, Annex §1): </strong>Risk category (məcburi), Risk nature (məcburi), Asset link (məcburi), Threat link (məcburi), Nonconformity link, IS event description, Consequence link, Probability level 1-5 (məcburi), Severity level 1-5 (məcburi), Qualitative score (auto-calculated, read-only), Quantitative value (auto-calculated), Treatment option (məcburi when assessed), Residual risk score.</p><p><strong>Threat Form (21 fields, Annex §3): </strong>Threat name, Category, Violated requirement, Violated principle, Requirement source, Activity area, Threat source (internal/external), Severity (5-level), Probability band (5 bands per §3.14), Purpose, Target object type, Intentionality, Exploited nonconformity, Nonconformity severity, Realization technology, Potential consequence, Threats to national IS, CIA property threats, ISMS org management threats, Technical management threats, Human capital threats, Physical security threats.</p><p><strong>Asset Form (§5.4): </strong>Asset name (məcburi), Category primary/supporting (məcburi), Asset value (məcburi for scoring), CIA levels (məcburi), Asset type, Owner, Location.</p><h2>F.3 Role-Based UI Visibility Rules</h2><ul><li>Read-Only: Can view all lists and details but NO create/edit/delete/approve buttons visible.</li><li>Risk Analyst: Full CRUD on risks, threats, assets, nonconformities. Cannot approve own submissions (SoD - approve button disabled for own records).</li><li>IS Officer: All Risk Analyst permissions plus: approve risks, configure thresholds, access all audit logs, generate reports.</li><li>Risk Owner: Can approve treatment plans for own risks. View-only for others' risks.</li><li>Operator/Admin: Full system administration. Cannot perform IS approval (SoD).</li><li>Xidmét Auditor: Read-only everywhere. Special access to effectiveness metrics dashboard and annual report.</li><li>Auditor: Full read access to audit logs. Read-only elsewhere.</li><li>Sensitive fields (nonconformity addresses, protection tool details per §9.5): Masked/hidden for Read-Only and Risk Owner roles. Visible only to IS Officer, Operator, Auditor.</li></ul><h2>F.4 Reporting Dashboards Required by Regulation (§10.2)</h2><ul><li>Configuration Compliance Dashboard (§10.2.1): 10 metric cards: (1) Asset coverage vs ISMS scope %, (2) Requirements vs Asset catalog alignment %, (3) IS baseline vs requirements alignment %, (4) Threat register vs IS baseline alignment %, (5) Risk registry vs threat register alignment %, (6) Treatment options vs risk registry alignment %, (7) Preventive/detective/corrective methods vs treatment options %, (8) Tools vs treatment methods alignment %, (9) Recovery methods vs consequence recovery alignment %, (10) Recovery tools vs treatment methods alignment %.</li><li>Functionality Effectiveness Dashboard (§10.2.2): 5 metric cards: (1) Data access completeness from all sources %, (2) Methods/tools relevance to new threats %, (3) Knowledge base accessibility for responsible parties %, (4) % of risks where residual risk stays within tolerance after treatment, (5) % of incidents aligned to their risk's residual risk level.</li><li>Risk Heat Map: 5×5 probability vs severity matrix. Filterable by category, asset, date.</li><li>Incident Trend: Monthly incident count, phase completion rates, time-to-resolve.</li><li>Treatment Status Summary: Pie chart of treatment options (avoid/mitigate/transfer/accept). Outstanding treatment plans count.</li><li>Catalog Sync Status: Last sync time, items added, conflicts pending.</li></ul><h1>G. DEVELOPER BACKLOG (Jira-Ready)</h1><p><em>Organized as Epics → User Stories → Tasks. Story points use Fibonacci scale. Dependencies noted where critical.</em></p><table><tr><td><p><strong>Story ID</strong></p></td><td><p><strong>Title</strong></p></td><td><p><strong>Story Points</strong></p></td><td><p><strong>Tasks</strong></p></td><td><p><strong>Acceptance Criteria (Given/When/Then)</strong></p></td></tr><tr><td colspan="5"><p><strong>EP-01: Infrastructure &amp; Foundation</strong></p></td></tr><tr><td><p><strong>US-0101</strong></p></td><td><p><strong>On-Prem DB Schema Setup</strong></p></td><td><p><strong>13</strong></p></td><td><p>• Install PostgreSQL 16 on-prem</p><p>• Create single database with single public schema</p><p>• Execute DDL for all rr_, loc_, cen_, inv_, sys_ tables</p><p>• Create indexes and FK constraints</p><p>• Configure RLS policies per RBAC matrix</p><p>• Configure pg_audit extension</p></td><td><p><em>GIVEN fresh environment WHEN DDL executed THEN all tables created, all FK constraints validated, RLS enabled.</em></p></td></tr><tr><td><p><strong>US-0102</strong></p></td><td><p><strong>RBAC &amp; Authentication Setup</strong></p></td><td><p><strong>8</strong></p></td><td><p>• Implement role definitions (7 roles)</p><p>• Integrate with org LDAP/AD</p><p>• Configure JWT tokens with role claims</p><p>• Implement SoD conflict detection</p><p>• Build role-assignment audit trail</p></td><td><p><em>GIVEN a user with Risk Analyst role WHEN they attempt to access cen_threat_catalog for write THEN 403 returned and audit log created.</em></p></td></tr><tr><td><p><strong>US-0103</strong></p></td><td><p><strong>Audit Log &amp; Immutability</strong></p></td><td><p><strong>8</strong></p></td><td><p>• Implement append-only sys_audit_log trigger on all tables</p><p>• Implement checksum computation per log row</p><p>• Implement sys_entity_snapshot on each mutating operation</p><p><br />[NON‑NORMATIVE HARDENING — RECOMMENDED ONLY] • Configure log retention policy</p></td><td><p><em>GIVEN any UPDATE to rr_risk THEN old_values and new_values captured in sys_audit_log with SHA-256 checksum within 100ms.</em></p></td></tr><tr><td colspan="5"><p><strong>EP-02: Asset &amp; Inventory Management</strong></p></td></tr><tr><td><p><strong>US-0201</strong></p></td><td><p><strong>Asset Catalog (loc_asset)</strong></p></td><td><p><strong>8</strong></p></td><td><p>• CRUD API for assets</p><p>• Asset classification form (primary/supporting)</p><p>• Asset value input with CIA scoring</p><p>• Asset import from CSV/CMDB</p><p>• Asset owner assignment</p></td><td><p><em>GIVEN IS Officer WHEN creates asset THEN asset saved with all mandatory fields, audit log entry created.</em></p></td></tr><tr><td><p><strong>US-0202</strong></p></td><td><p><strong>Solution Technology Inventory (inv_solution_tool)</strong></p></td><td><p><strong>8</strong></p></td><td><p>• CRUD API for solution tools</p><p>• Tool certification tracking fields</p><p>• AI technology tag multi-select</p><p>• EAL level field with validation</p><p>• Certification expiry alert</p></td><td><p><em>GIVEN Operator WHEN adds SIEM tool without certification flag THEN system warns; EAL level 6 required for technical tools.</em></p></td></tr><tr><td colspan="5"><p><strong>EP-03: Risk Assessment Engine</strong></p></td></tr><tr><td><p><strong>US-0301</strong></p></td><td><p><strong>Threat Identification (loc_threat)</strong></p></td><td><p><strong>13</strong></p></td><td><p>• 21-field threat form per Annex §3</p><p>• Severity/probability selector (5-level scales)</p><p>• Link threat to asset, nonconformity, consequence</p><p>• Threat source classification (internal/external)</p><p>• Threat intentionality field</p></td><td><p><em>GIVEN Risk Analyst WHEN creates threat THEN all 21 Annex §3 fields captured; probability stored as enum band matching §3.14 ranges.</em></p></td></tr><tr><td><p><strong>US-0302</strong></p></td><td><p><strong>Nonconformity Registry (loc_nonconformity)</strong></p></td><td><p><strong>5</strong></p></td><td><p>• Nonconformity CRUD with 4 mandatory fields</p><p>• Link to asset and threat</p><p>• Severity classification</p><p>• Remediation tracking</p></td><td><p><em>GIVEN nonconformity linked to threat THEN risk record inherits nonconformity reference.</em></p></td></tr><tr><td><p><strong>US-0303</strong></p></td><td><p><strong>Risk Scoring Engine</strong></p></td><td><p><strong>13</strong></p></td><td><p>• Implement qualitative formula: RD = AV × P_avg_max × I_max (§4.2.3.4)</p><p>• Implement quantitative formula: RV = AV × F% × I_max (§4.2.3.5)</p><p>• Auto-calculation on save</p><p>• Formula audit trail (store inputs used)</p><p>• Risk prioritization by asset value</p><p>• Residual risk tracking</p></td><td><p><em>GIVEN asset value=100, probability=0.6, impact=0.8 WHEN risk scored THEN qualitative score=48.0 stored with formula inputs in audit.</em></p></td></tr><tr><td><p><strong>US-0304</strong></p></td><td><p><strong>Risk Lifecycle State Machine</strong></p></td><td><p><strong>8</strong></p></td><td><p>• States: identified→assessed→treating→closed/accepted</p><p>• Transition guards (only IS Officer can approve)</p><p>• SoD enforcement on transitions</p><p>• Email/notification on state change</p><p>• Bulk state update</p></td><td><p><em>GIVEN risk in assessed state WHEN Risk Owner attempts to approve without IS Officer THEN 403 returned (SoD violation).</em></p></td></tr><tr><td colspan="5"><p><strong>EP-04: Risk Treatment &amp; Incident Response</strong></p></td></tr><tr><td><p><strong>US-0401</strong></p></td><td><p><strong>Treatment Plan Management</strong></p></td><td><p><strong>8</strong></p></td><td><p>• Treatment option selector (avoid/mitigate/transfer/accept)</p><p>• Method and tool assignment</p><p>• Approval workflow</p><p>• Treatment effectiveness date tracking</p><p>• Link to cen_solution for generic solutions</p></td><td><p><em>GIVEN high-risk with no treatment plan after 5 days THEN automated escalation alert to Risk Owner.</em></p></td></tr><tr><td><p><strong>US-0402</strong></p></td><td><p><strong>Incident Response Workflow (13 phases)</strong></p></td><td><p><strong>13</strong></p></td><td><p>• 13-phase incident workflow per Annex §6.1.5</p><p>• Phase transition with timestamps</p><p>• Evidence attachment per phase</p><p>• Incident-to-risk linkage</p><p>• Incident reporting dashboard</p></td><td><p><em>GIVEN incident opened WHEN all 13 phases completed THEN incident can be closed; phase log immutable.</em></p></td></tr><tr><td colspan="5"><p><strong>EP-05: Central Catalog &amp; Integration</strong></p></td></tr><tr><td><p><strong>US-0501</strong></p></td><td><p><strong>Central Threat Catalog Sync (Import)</strong></p></td><td><p><strong>13</strong></p></td><td><p>• REST/API client for Xidmét catalog</p><p>• Delta sync with conflict detection</p><p>• Sync scheduling (≤24h intervals)</p><p>• Sync log with full audit trail</p><p>• Manual sync trigger for admin</p></td><td><p><em>GIVEN Xidmét publishes new threat WHEN sync runs THEN threat imported to cen_threat_catalog within 24h and sync logged.</em></p></td></tr><tr><td><p><strong>US-0502</strong></p></td><td><p><strong>New Threat Export to Catalog</strong></p></td><td><p><strong>8</strong></p></td><td><p>• Identify locally-discovered threats not in central catalog</p><p>• Export package creation</p><p>• Submit to Xidmét API</p><p>• Track submission status</p><p>• Bidirectional reconciliation</p></td><td><p><em>GIVEN new threat confirmed by IS Officer WHEN submitted to catalog THEN submission receipt stored in rr_reconciliation.</em></p></td></tr><tr><td><p><strong>US-0503</strong></p></td><td><p><strong>Requirement &amp; Threshold Management (cen_requirement, cen_threshold)</strong></p></td><td><p><strong>8</strong></p></td><td><p>• IS requirements CRUD with source tracking</p><p>• MAO/MBCO threshold configuration</p><p>• CIA threshold configuration</p><p>• SLA/OLA threshold configuration</p><p>• EAL threshold recording</p></td><td><p><em>GIVEN requirement from ISO/IEC 27001 WHEN added THEN source_type=standard, source_reference recorded; versioned.</em></p></td></tr><tr><td colspan="5"><p><strong>EP-06: Real-Time Logging &amp; SIEM Integration</strong></p></td></tr><tr><td><p><strong>US-0601</strong></p></td><td><p><strong>Real-Time Centralized Log Collection (§6.9.2)</strong></p></td><td><p><strong>13</strong></p></td><td><p>• Configure syslog/event forwarder from application</p><p>• Real-time ingestion to sys_audit_log</p><p>• Integration with on-prem SIEM (e.g., Wazuh, Splunk)</p><p>• Log completeness monitoring</p><p>• Alert on log gap &gt;1 min</p></td><td><p><em>GIVEN IS event (threat detected) WHEN event fires THEN log entry in sys_audit_log within 60s; SIEM notified.</em></p></td></tr><tr><td colspan="5"><p><strong>EP-07: Reporting &amp; Effectiveness Metrics</strong></p></td></tr><tr><td><p><strong>US-0701</strong></p></td><td><p><strong>KPI Dashboard (15 Metrics per §10.2)</strong></p></td><td><p><strong>13</strong></p></td><td><p>• 10 configuration compliance metrics</p><p>• 5 functionality effectiveness metrics</p><p>• Metric calculation engine</p><p>• Dashboard visualization</p><p>• Export to PDF for Xidmét submission</p><p>• Scheduled metric computation</p></td><td><p><em>GIVEN owner accesses dashboard WHEN all 15 metrics computed THEN scores displayed with traffic-light indicators; exportable.</em></p></td></tr><tr><td><p><strong>US-0702</strong></p></td><td><p><strong>Annual Effectiveness Report</strong></p></td><td><p><strong>5</strong></p></td><td><p>• Report template per §10.3</p><p>• Owner sign-off workflow</p><p>• Submission tracking to Xidmét</p><p>• Historical comparison</p></td><td><p><em>GIVEN annual report due WHEN owner generates THEN all 15 metrics included with trend vs prior year.</em></p></td></tr><tr><td><p><strong>US-0703</strong></p></td><td><p><strong>RACI Matrix Builder</strong></p></td><td><p><strong>5</strong></p></td><td><p>• Process-role assignment UI</p><p>• SoD conflict detection on save</p><p>• RACI export to PDF</p><p>• Version history for RACI changes</p></td><td><p><em>GIVEN admin assigns same role R and oversight THEN SoD violation flagged and blocked.</em></p></td></tr><tr><td colspan="5"><p><strong>EP-08: Security &amp; Compliance (EAL6 + Maturity Level 4)</strong></p></td></tr><tr><td><p><strong>US-0801</strong></p></td><td><p><strong>EAL6 Compliance Artifacts</strong></p></td><td><p><strong>21</strong></p></td><td><p>• Document security architecture for evaluation</p><p>• Prepare functional specification (FSP)</p><p>• Prepare design spec (TDS, ADD)</p><p>• Prepare implementation representation</p><p>• Prepare test documentation (test scenarios, results)</p><p>• Engage certification body for ISO/IEC 15408 EAL6 evaluation</p><p>• Penetration testing plan and execution</p><p>• Vulnerability assessment artifacts</p></td><td><p><em>GIVEN EAL6 evaluation WHEN artifacts submitted THEN all required evidence documents provided per ISO/IEC 15408.</em></p></td></tr><tr><td><p><strong>US-0802</strong></p></td><td><p><strong>ISO/IEC 15504 Maturity Level 4 Assessment</strong></p></td><td><p><strong>13</strong></p></td><td><p>• Process capability assessment</p><p>• Document knowledge base</p><p>• Define and measure process metrics</p><p>• Prepare evidence records</p><p>• Remediate gaps to achieve level 4</p></td><td><p><em>GIVEN maturity assessment WHEN scored THEN organizational processes achieve level ≥4 with documented evidence.</em></p></td></tr><tr><td><p><strong>US-0803</strong></p></td><td><p><strong>Data Residency &amp; DLP Controls (§9.5)</strong></p></td><td><p><strong>8</strong></p></td><td><p>• Implement export restrictions on sensitive tables</p><p>• DLP policy for main table, nonconformity addresses, protection methods</p><p>• Encrypt sensitive fields at rest (AES-256)</p><p>• No-transfer enforcement: block bulk export of rr_risk central table</p><p>• Data classification labels on all records</p></td><td><p><em>GIVEN attempt to export rr_risk main table to external location THEN blocked and alert raised.</em></p></td></tr></table><h2>G.2 Key Dependencies</h2><ul><li>EP-01 (Infrastructure) → All other epics. Must complete US-0101, US-0102, US-0103 before any feature development.</li><li>EP-02 (Assets) → EP-03 (Risk Assessment): Asset catalog must exist before risk scoring.</li><li>EP-03 (Risk Assessment) → EP-04 (Treatment): Risk must be assessed before treatment.</li><li>EP-03 (Risk Assessment) → EP-07 (Metrics): Risk data needed for metric calculation.</li><li>EP-05 (Catalog Integration) → Must define Xidmét API spec/protocol before implementation. Block on external agreement with Xidmét.</li><li>EP-08 (EAL6/Security) → Starts in parallel from Day 1. EAL6 evaluation requires frozen codebase and completed security architecture docs. Recommend initiating evaluation process at project start.</li><li>US-0601 (SIEM) → Requires SIEM product selection and on-prem installation before development.</li></ul><h2>G.3 Rough Total Estimates</h2><p>Total Story Points: ~175 SP | Assuming 2-week sprints at 25 SP/sprint team velocity → ~14 sprints (~7 months for feature delivery) + ~2-3 months for EAL6 evaluation process (parallel track) + ~1 month UAT/hardening. Recommend team of 2 backend + 1 frontend + 1 DBA + 1 IS specialist + 1 project manager.</p><h1>H. TEST PLAN</h1><h2>H.1 Test Cases (Requirement-Based)</h2><table><tr><td><p><strong>TC-ID</strong></p></td><td><p><strong>Req Ref</strong></p></td><td><p><strong>Type</strong></p></td><td><p><strong>Title</strong></p></td><td><p><strong>Steps</strong></p></td><td><p><strong>Expected Result</strong></p></td><td><p><strong>Role</strong></p></td></tr><tr><td><p><strong>TC-001</strong></p></td><td><p><em>RR-REQ-0013</em></p></td><td><p><strong>Positive</strong></p></td><td><p>Qualitative Risk Score Calculation</p></td><td><p>1. Create asset (value=100), 2. Create threat (prob=3/5), 3. Create risk linking both, 4. Set impact factors (tech=4, biz=3), 5. Save risk</p></td><td><p>qualitative_score = 100 × 3 × 4 = 1200 stored; formula inputs logged in sys_audit_log</p></td><td><p>Risk Analyst</p></td></tr><tr><td><p><strong>TC-002</strong></p></td><td><p><em>RR-REQ-0013</em></p></td><td><p><strong>Negative</strong></p></td><td><p>Reject Zero-Asset-Value Risk</p></td><td><p>1. Create asset (value=0), 2. Create risk linking asset, 3. Attempt to save</p></td><td><p>Validation error: asset_value must be &gt; 0 for risk scoring; risk not saved</p></td><td><p>Risk Analyst</p></td></tr><tr><td><p><strong>TC-003</strong></p></td><td><p><em>RR-REQ-0005</em></p></td><td><p><strong>RBAC</strong></p></td><td><p>SoD: Risk Analyst Cannot Approve Own Risk</p></td><td><p>1. Risk Analyst creates risk RR-001, 2. Risk Analyst attempts to approve RR-001 (transition to treating)</p></td><td><p>403 Forbidden; SoD violation logged in sys_audit_log with reason</p></td><td><p>Risk Analyst (blocked)</p></td></tr><tr><td><p><strong>TC-004</strong></p></td><td><p><em>RR-REQ-0030</em></p></td><td><p><strong>RBAC</strong></p></td><td><p>Read-Only Role Cannot Write</p></td><td><p>1. Login as Read-Only user, 2. POST /api/risks with valid payload</p></td><td><p>403 Forbidden; attempt logged</p></td><td><p>Read-Only</p></td></tr><tr><td><p><strong>TC-005</strong></p></td><td><p><em>RR-REQ-0030</em></p></td><td><p><strong>RBAC</strong></p></td><td><p>Xidmét Auditor Read-Only Access</p></td><td><p>1. Login as Xidmét Auditor, 2. GET /api/risks - success, 3. DELETE /api/risks/id - fail</p></td><td><p>GET returns 200 with data; DELETE returns 403</p></td><td><p>Xidmét Auditor</p></td></tr><tr><td><p><strong>TC-006</strong></p></td><td><p><em>RR-REQ-0026</em></p></td><td><p><strong>Audit</strong></p></td><td><p>Real-Time Log on Risk Update</p></td><td><p>1. Update risk status to assessed, 2. Check sys_audit_log within 60s</p></td><td><p>Log entry with action=UPDATE, table_name=rr_risk, old_values and new_values populated, checksum computed</p></td><td><p>Risk Analyst</p></td></tr><tr><td><p><strong>TC-007</strong></p></td><td><p><em>RR-REQ-0003</em></p></td><td><p><strong>Audit</strong></p></td><td><p>Audit Log Immutability</p></td><td><p>1. As Admin, attempt to DELETE from sys_audit_log, 2. As Admin, attempt to UPDATE sys_audit_log</p></td><td><p>Both operations fail; RLS policy denies DELETE and UPDATE on sys_audit_log for all roles</p></td><td><p>Admin (blocked)</p></td></tr><tr><td><p><strong>TC-008</strong></p></td><td><p><em>RR-REQ-0025</em></p></td><td><p><strong>Reconciliation</strong></p></td><td><p>Asset Sync Reconciliation</p></td><td><p>1. Update loc_asset record, 2. Trigger reconciliation for linked rr_risk, 3. Check rr_reconciliation</p></td><td><p>rr_reconciliation updated with sync_status=synced, last_synced_at current</p></td><td><p>Operator</p></td></tr><tr><td><p><strong>TC-009</strong></p></td><td><p><em>RR-REQ-0028</em></p></td><td><p><strong>Reconciliation</strong></p></td><td><p>Central Catalog Import Reconciliation</p></td><td><p>1. Trigger catalog sync, 2. Catalog returns 5 new threats, 3. Check cen_threat_catalog and sys_audit_log</p></td><td><p>5 new threats inserted, sync log entry with action=IMPORT, last_synced_at updated</p></td><td><p>Operator (sync service)</p></td></tr><tr><td><p><strong>TC-010</strong></p></td><td><p><em>RR-REQ-0035</em></p></td><td><p><strong>Data Integrity</strong></p></td><td><p>Bulk Export Blocked for Main Table</p></td><td><p>1. IS Officer attempts bulk CSV export of rr_risk table, 2. Check DLP log</p></td><td><p>Export blocked by DLP policy; alert generated; audit log entry action=EXPORT_BLOCKED</p></td><td><p>IS Officer</p></td></tr><tr><td><p><strong>TC-011</strong></p></td><td><p><em>RR-REQ-0041</em></p></td><td><p><strong>Positive</strong></p></td><td><p>All 21 Threat Fields Required</p></td><td><p>1. Attempt to save loc_threat with only 15 fields populated</p></td><td><p>Validation error listing the 6 missing mandatory fields; record not saved</p></td><td><p>Risk Analyst</p></td></tr><tr><td><p><strong>TC-012</strong></p></td><td><p><em>RR-REQ-0037</em></p></td><td><p><strong>Audit</strong></p></td><td><p>Effectiveness Metrics Calculation</p></td><td><p>1. Trigger metric calculation for all 15 KPIs, 2. Review dashboard</p></td><td><p>All 15 metrics computed; each metric has a score between 0-100%; dashboard renders green/amber/red indicators</p></td><td><p>IS Officer / Owner</p></td></tr><tr><td><p><strong>TC-013</strong></p></td><td><p><em>RR-REQ-0034</em></p></td><td><p><strong>Compliance</strong></p></td><td><p>EAL Certification Field Enforced for Technical Tools</p></td><td><p>1. Add inv_solution_tool of type software without is_certified=true, 2. Attempt to mark tool as active</p></td><td><p>Warning displayed; activation requires certification confirmation; audit logged</p></td><td><p>Operator</p></td></tr><tr><td><p><strong>TC-014</strong></p></td><td><p><em>RR-REQ-0044</em></p></td><td><p><strong>Positive</strong></p></td><td><p>Incident 13-Phase Workflow Completion</p></td><td><p>1. Create incident linked to risk, 2. Progress through all 13 phases in order, 3. Attempt to skip phase 7</p></td><td><p>Phase 7 skip rejected; phases must be sequential; all 13 completions logged with timestamps</p></td><td><p>IS Officer</p></td></tr><tr><td><p><strong>TC-015</strong></p></td><td><p><em>RR-REQ-0034</em></p></td><td><p><strong>Pentest/V&amp;V</strong></p></td><td><p>Penetration Test - SQL Injection on Risk API</p></td><td><p>1. Send SQL injection payload in risk_category field, 2. Check DB and response</p></td><td><p>Input sanitized; parameterized query used; no DB error exposed; attempt logged</p></td><td><p>External Penetration Tester</p></td></tr></table><h2>H.2 EAL6 Verification &amp; Validation — Required Artifacts (§9.4)</h2><p><em>Per §9.4, technical tools must achieve ISO/IEC 15408 EAL 6 (verification, validation, and penetration testing performed, test scenarios and results documented). The following artifacts are MANDATORY:</em></p><ul><li>Security Target (ST): Formal security claims document. Defines TOE (Target of Evaluation), security objectives, SFRs (Security Functional Requirements), SARs (Security Assurance Requirements) at EAL6.</li><li>Protection Profile (PP): If applicable, reference to national/international PP.</li><li>Functional Specification (FSP): Complete description of TSF (TOE Security Functions) external interfaces.</li><li>TOE Design (TDS): High-level and low-level design documentation of security-relevant subsystems.</li><li>Implementation Representation: Source code and/or implementation artifacts for security-relevant components.</li><li>Test Documentation: ADV_FSP test cases, ATE_DPT depth testing, ATE_FUN functional test procedures, ATE_IND independent testing evidence.</li><li>Vulnerability Analysis (AVA_VAN): Formal vulnerability analysis report. Penetration test plan, execution evidence, and results. All discovered vulnerabilities with severity ratings and remediation evidence.</li><li>Life Cycle Support (ALC_*): Configuration management plan, flaw remediation procedure, development security documentation.</li><li>Guidance Documents (AGD_OPE, AGD_PRE): Operational user guidance and preparative guidance.</li><li>Composition Analysis: If TSF components composed from already-evaluated elements.</li></ul><h2>H.3 Penetration Testing Scope</h2><ul><li><br />[NON‑NORMATIVE HARDENING — RECOMMENDED ONLY] Authentication &amp; Session: Brute force, session fixation, JWT manipulation, token expiry bypass.</li><li>Authorization / RBAC: Privilege escalation, IDOR (insecure direct object reference), SoD bypass attempts.</li><li>API Security: SQL injection, parameter tampering, mass assignment, rate limiting bypass.</li><li>Data Confidentiality: Sensitive field exposure (nonconformity addresses, protection methods per §9.5), bulk export bypass, encryption verification.</li><li>Audit Log Integrity: Attempt to modify/delete audit log entries, checksum bypass.</li><li>Real-Time Logging: Test log completeness under load; simulate log gap scenarios.</li><li>Sync/Integration: Man-in-middle on catalog sync channel, tampered catalog data injection.</li><li>Network: Port scanning, unencrypted channel detection, TLS configuration.</li><li>Physical/Infrastructure: Applicable to on-prem deployment: unauthorized physical access scenarios.</li></ul><h2>H.4 ISO/IEC 15504 Maturity Level 4 Evidence Documents</h2><ul><li>Process capability assessment report per ISO/IEC 15504-2 for all risk management processes.</li><li>Process performance measurements and metrics (aligned to SMART criteria per §3.1.5).</li><li>Knowledge base documentation: predefined/approved criteria for each process.</li><li>Evidence records: process logs showing sufficient documentation, measurable outcomes.</li><li>Process improvement records: planned and executed improvement actions.</li><li>Gap analysis against Level 4 attributes: PA4.1 (Process Measurement), PA4.2 (Process Control).</li></ul><h2>H.5 Clarifications Needed</h2><p>The following clauses are ambiguous; safest compliant implementation option proposed:</p><ul><li>§7.1.4 'Catalog submission': Regulation says threats must be 'ötürülməsi' (transferred) to Xidmét catalog but does not specify the API/protocol. Safest option: encrypted SFTP or REST API with mutual TLS. ACTION: Confirm protocol with Xidmét.</li><li>§5.6 'Central source structure': States central DB mirrors main DB structure 'except' certain exclusions (§5.6.1-5.6.4). Interpretation: local fields like nonconformity addresses are excluded from central catalog. Implemented as: central catalog tables omit address/location fields.</li><li>§9.4 'Technical tools EAL 6': Unclear if EAL6 applies to the entire application or specific security-enforcing modules. Safest: design security architecture to allow EAL6 evaluation of the core security enforcement modules (authentication, RBAC, audit) as TOE.</li><li>§6.9 'ICT maintenance agreement': Regulation requires maintenance to be formalized in a 'razılaşdırma sənədi' (agreement document). Interpreted as SLA/OLA document between owner and operator. Implemented as: SLA configuration screen storing agreed thresholds in cen_threshold.</li><li>§10.2 Metric formulas: The 15 metrics are defined as 'degree of compliance' ('uyğunluq dərəcəsi') without explicit calculation formulas. Proposed: express each as percentage of items meeting criteria / total items × 100. Needs validation with Xidmét.</li></ul><h1>REQUIREMENTS TRACEABILITY SUMMARY</h1><table><tr><td><p><strong>Req ID</strong></p></td><td><p><strong>Short Description</strong></p></td><td><p><strong>BR Mapped</strong></p></td><td><p><strong>DB Table(s)</strong></p></td><td><p><strong>API</strong></p></td><td><p><strong>UI Screen</strong></p></td><td><p><strong>Epic</strong></p></td><td><p><strong>Test Case</strong></p></td><td><p><strong>Priority</strong></p></td></tr><tr><td><p><strong>RR-REQ-0001</strong></p></td><td><p>Data confidentiality &amp; storage</p></td><td><p>BR-0001</p></td><td><p>rr_risk, sys_audit_log</p></td><td><p>All</p></td><td><p>All</p></td><td><p>EP-01, EP-08</p></td><td><p>TC-010</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0002</strong></p></td><td><p>Mandatory for state bodies</p></td><td><p>BR-0002</p></td><td><p>—</p></td><td><p>—</p></td><td><p>Dashboard</p></td><td><p>—</p></td><td><p>—</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0005</strong></p></td><td><p>SoD enforcement</p></td><td><p>BR-0003</p></td><td><p>cen_raci_matrix</p></td><td><p>POST /risks/transition, POST /raci</p></td><td><p>RACI Screen</p></td><td><p>EP-01</p></td><td><p>TC-003</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0007</strong></p></td><td><p>Asset identification</p></td><td><p>BR-0004</p></td><td><p>loc_asset</p></td><td><p>GET/POST /assets</p></td><td><p>Aktiv Kataloqu</p></td><td><p>EP-02</p></td><td><p>TC-011</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0013</strong></p></td><td><p>Qualitative risk score</p></td><td><p>BR-0005</p></td><td><p>rr_risk</p></td><td><p>GET /risks/{id}/score</p></td><td><p>Risk Form</p></td><td><p>EP-03</p></td><td><p>TC-001, TC-002</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0014</strong></p></td><td><p>Quantitative risk value</p></td><td><p>BR-0006</p></td><td><p>rr_risk</p></td><td><p>GET /risks/{id}/score</p></td><td><p>Risk Form</p></td><td><p>EP-03</p></td><td><p>TC-001</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0015</strong></p></td><td><p>Treatment option selection</p></td><td><p>BR-0007</p></td><td><p>rr_treatment</p></td><td><p>POST /treatments</p></td><td><p>Risk Emal</p></td><td><p>EP-04</p></td><td><p>—</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0017</strong></p></td><td><p>4-component DB structure</p></td><td><p>BR-0008</p></td><td><p>All prefixes</p></td><td><p>—</p></td><td><p>—</p></td><td><p>EP-01</p></td><td><p>TC-008</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0026</strong></p></td><td><p>Real-time log collection</p></td><td><p>BR-0009</p></td><td><p>sys_audit_log</p></td><td><p>GET /audit-logs</p></td><td><p>Audit Jurnalı</p></td><td><p>EP-06</p></td><td><p>TC-006, TC-007</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0027</strong></p></td><td><p>RACI matrices</p></td><td><p>BR-0010</p></td><td><p>cen_raci_matrix</p></td><td><p>GET/POST /raci</p></td><td><p>RACI Matrisası</p></td><td><p>EP-01, EP-07</p></td><td><p>TC-003</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0034</strong></p></td><td><p>EAL6 + Maturity L4</p></td><td><p>BR-0011</p></td><td><p>—</p></td><td><p>—</p></td><td><p>—</p></td><td><p>EP-08</p></td><td><p>TC-013, TC-015</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0035</strong></p></td><td><p>Data residency protection</p></td><td><p>BR-0012</p></td><td><p>rr_risk (main table)</p></td><td><p>—</p></td><td><p>Sensitive field masks</p></td><td><p>EP-08</p></td><td><p>TC-010</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0037</strong></p></td><td><p>Annual effectiveness eval</p></td><td><p>BR-0013</p></td><td><p>—</p></td><td><p>POST /reports/effectiveness</p></td><td><p>İllik Hesabat</p></td><td><p>EP-07</p></td><td><p>TC-012</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0041</strong></p></td><td><p>21-field threat capture</p></td><td><p>BR-0004</p></td><td><p>loc_threat</p></td><td><p>POST /threats</p></td><td><p>Təhdid Əlavə et</p></td><td><p>EP-03</p></td><td><p>TC-011</p></td><td><p><strong>High</strong></p></td></tr><tr><td><p><strong>RR-REQ-0044</strong></p></td><td><p>13-phase incident response</p></td><td><p>BR-0015</p></td><td><p>rr_incident</p></td><td><p>PUT /incidents/{id}/phase</p></td><td><p>İnsident Detalı</p></td><td><p>EP-04</p></td><td><p>TC-014</p></td><td><p><strong>High</strong></p></td></tr></table><p><em>END OF DOCUMENT — İnformasiya Təhlükəsizliyi Riskləri Reyestri Implementation Plan</em></p><p>Nazirlər Kabinetinin 25.12.2025 tarixli 411 nömrəli Qərarı əsasında | On-Premises | Single Schema</p><p><strong>PATCH ADDENDUM — Compliance Corrections (Normative vs Non‑Normative)</strong></p><p>This addendum corrects identified compliance gaps and removes or reclassifies any invented requirements. It must be applied on top of the main implementation plan.</p><p><strong>1) Normative Coverage Gaps — Add Missing Requirements</strong></p><p>Add the following missing normative requirements as RR‑REQ items and map them to BR/AC/Test cases. These items were present in the regulation but were not explicitly extracted as requirements.</p><table><tr><td><p>ID</p></td><td><p>Clause</p></td><td><p>Normative text (short)</p></td><td><p>Category</p></td><td><p>Type</p></td><td><p>Priority</p></td><td><p>Implementation note</p></td></tr><tr><td><p>RR-REQ-NEW-0001</p></td><td><p>§1.7</p></td><td><p>Unregulated matters must be implemented according to other applicable rules (reference mechanism).</p></td><td><p>Compliance/Certification</p></td><td><p>Constraint</p></td><td><p>Medium</p></td><td><p>Implement a 'Reference Registry' for external governing documents and a decision log linking each gap to an authoritative rule.</p></td></tr><tr><td><p>RR-REQ-NEW-0002</p></td><td><p>§1.9</p></td><td><p>If the organization is Critical Information Infrastructure (KII), additional normative acts must be applied.</p></td><td><p>Compliance/Certification</p></td><td><p>Constraint</p></td><td><p>High</p></td><td><p>Introduce an organization-level KII flag and conditional compliance branch (extra controls/checklists/reports).</p></td></tr><tr><td><p>RR-REQ-NEW-0003</p></td><td><p>§5.1</p></td><td><p>The registry structure must be defined in accordance with the rule and standards must be considered.</p></td><td><p>Data/DB + Compliance</p></td><td><p>Constraint</p></td><td><p>High</p></td><td><p>Create an explicit Data Dictionary and Standards Alignment section (fields → DB → API → UI → validation).</p></td></tr><tr><td><p>RR-REQ-NEW-0004</p></td><td><p>§5.3</p></td><td><p>Registry must be populated with data per the Annex (mandatory data completeness).</p></td><td><p>Data/DB</p></td><td><p>Constraint</p></td><td><p>High</p></td><td><p>Enforce Annex-based mandatory fields at state transitions (Draft→Assessed→Approved).</p></td></tr><tr><td><p>RR-REQ-NEW-0005</p></td><td><p>§5.6</p></td><td><p>Data structures must be created in alignment with specified structures (with exceptions).</p></td><td><p>Data/DB</p></td><td><p>Constraint</p></td><td><p>Medium</p></td><td><p>Document exceptions explicitly; implement via table prefixes + views + RBAC/RLS (single schema).</p></td></tr><tr><td><p>RR-REQ-NEW-0006</p></td><td><p>§5.7</p></td><td><p>Inventory structure must be created considering the prescribed inventory structure.</p></td><td><p>Inventory + Data/DB</p></td><td><p>Constraint</p></td><td><p>Medium</p></td><td><p>Define inv_* tables and link treatment solutions to inventory technologies.</p></td></tr></table><p><strong>2) Remove / Reclassify Invented Requirements</strong></p><p><br />[NON‑NORMATIVE HARDENING — RECOMMENDED ONLY] The following items are security best practices but are not explicitly mandated by the regulation. They MUST NOT be written as normative 'MUST/SHALL' requirements. Reclassify them under 'Recommended Security Hardening' and keep them risk-based and optional unless separately mandated.</p><p>• AES‑256 at rest / specific cipher mandates</p><p>• JWT expiry fixed at 8 hours</p><p>• Strict prohibition of direct DB access except VPN+MFA (unless separately governed)</p><p>• Browser localStorage caching prohibition (unless separately governed)</p><p><br />[NON‑NORMATIVE HARDENING — RECOMMENDED ONLY] • Retention: 'minimum 5 years' or 'lifetime + 3 years' (unless explicitly mandated elsewhere)</p><p>• Nightly checksum verification (unless recommended by assurance program)</p><p><br />[NON‑NORMATIVE HARDENING — RECOMMENDED ONLY] Recommended Security Hardening (Non‑Normative)</p><p>Place all hardening controls here, with 'RECOMMENDED' language, and tie them to a risk statement, not to the regulation.</p><p><strong>3) Logging: Separate Audit Trail vs Operational/Security Event Logs</strong></p><p>Correct the conceptual mismatch: the regulation’s real‑time centralized log collection requirement is operational/security event logging. Application audit trail (who changed what) is a separate mechanism. Implement both and forward both to the centralized log store/SIEM.</p><p><strong>Audit Trail (Immutable)</strong></p><p>• Table: sys_audit_log (append‑only).</p><p>• Captures CRUD + state transitions + approvals + export blocks.</p><p>• DB enforcement: deny UPDATE/DELETE; only INSERT by service account.</p><p><strong>Operational / Security Event Logs (Real‑Time Centralized)</strong></p><p>• Stream: sys_event_log (or external log pipeline) for application/system/security events.</p><p>• Forward in real time to centralized log storage / SIEM.</p><p>• Use correlation IDs to link events to sys_audit_log and to business entities (risk_id, asset_id, etc.).</p><p><strong>4) RBAC Fix — Audit Log Must Never Be CRUD by Users</strong></p><p>Fix the access matrix: auditors must have READ only. No human role may UPDATE/DELETE audit logs.</p><table><tr><td><p>Object</p></td><td><p>Create/Insert</p></td><td><p>Read</p></td><td><p>Update/Delete</p></td></tr><tr><td><p>sys_audit_log</p></td><td><p>Service account only</p></td><td><p>AUDITOR / SEC_OFFICER (read)</p></td><td><p>Nobody</p></td></tr><tr><td><p>version_snapshots</p></td><td><p>Service account only</p></td><td><p>AUDITOR / SEC_OFFICER (read)</p></td><td><p>Nobody</p></td></tr><tr><td><p>sys_event_log</p></td><td><p>System/agents</p></td><td><p>SOC/AUDITOR (read)</p></td><td><p>Nobody (prefer append-only)</p></td></tr></table><p><strong>5) Allowed Values (Enums) Must Match Regulation Terminology 1:1</strong></p><p>Where the regulation defines named severity/probability levels, the system must use the same labels and ranges. Do not substitute 5‑level 'very_low…critical' scales if the regulation uses a different scheme. Update DB enums/check constraints, API validation, UI dropdown labels, reports, and test vectors.</p><p><strong>6) Annex Field‑to‑System Data Dictionary (Mandatory)</strong></p><p>Create a Data Dictionary mapping every Annex field to: DB column(s) → API contract → UI label → validation rules → state transition gates. This ensures completeness and auditability.</p><table><tr><td><p>Annex field (name)</p></td><td><p>DB column(s)</p></td><td><p>API field</p></td><td><p>UI label (AZ)</p></td><td><p>Validation</p></td><td><p>Gate (state)</p></td></tr><tr><td><p>Risk category &amp; description</p></td><td><p>rr_risk.risk_category, rr_risk.description</p></td><td><p>riskCategory, description</p></td><td><p>Risk kateqoriyası / Təsvir</p></td><td><p>Required for Assess</p></td><td><p>Draft→Assessed</p></td></tr><tr><td><p>Threat scheme &amp; probability/severity</p></td><td><p>rr_risk.threat_scheme, rr_risk.threat_probability, rr_risk.threat_severity</p></td><td><p>threatScheme, threatProbability, threatSeverity</p></td><td><p>Təhdid sxemi / Ehtimal / Ciddilik</p></td><td><p>Required for Assess</p></td><td><p>Draft→Assessed</p></td></tr><tr><td><p>Reconciliation info</p></td><td><p>rr_risk.reconciliation_ref, rr_reconciliation.*</p></td><td><p>reconciliationRef</p></td><td><p>Uzlaşdırma məlumatları</p></td><td><p>Optional unless reconciliation enabled</p></td><td><p>Any</p></td></tr></table><p><strong>7) Minimal Evidence Pack Required for EAL6/V&amp;V</strong></p><p>Maintain the following artifacts as evidence: Traceability matrix, test plans and results, penetration testing report and remediation verification, configuration baselines, and immutable audit/snapshot proofs.</p><p><strong>8) Action List (Apply These Changes)</strong></p><p>• Add missing RR‑REQ items (section 1) and update BRD/AC/Test/Traceability.</p><p><br />[NON‑NORMATIVE HARDENING — RECOMMENDED ONLY] • Move all invented 'MUST' security/retention items into a Non‑Normative 'Recommended Hardening' section.</p><p>• Split logging into sys_audit_log (audit trail) and sys_event_log (operational/security events) and forward both to centralized log store.</p><p>• Fix RBAC: audit and snapshot tables are read‑only to auditors; never update/delete.</p><p>• Align enums/allowed values to regulation language and ranges across DB/API/UI.</p><p>• Create the Annex Data Dictionary mapping and enforce it at workflow gates.</p>
